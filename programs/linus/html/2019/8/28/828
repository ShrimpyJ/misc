    </div></td><td width="32"> </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2019/8/28/828">First message in thread</a></li><li class="origin"><a href="">"tip-bot2 for Linus Torvalds"</a></li></ul><div class="threadlist">Patch in this message</div><ul class="threadlist"><li><a href="/lkml/diff/2019/8/28/828/1">Get diff 1</a></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1305798" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Wed, 28 Aug 2019 16:09:48 -0000</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">"tip-bot2 for Linus Torvalds" &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">[tip: x86/urgent] x86/build: Add -Wnoaddress-of-packed-member to REALMODE_CFLAGS, to silence GCC9 build warning</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">The following commit has been merged into the x86/urgent branch of tip:<br /><br />Commit-ID:     42e0e95474fc6076b5cd68cab8fa0340a1797a72<br />Gitweb:        <a href="https://git.kernel.org/tip/42e0e95474fc6076b5cd68cab8fa0340a1797a72">https://git.kernel.org/tip/42e0e95474fc6076b5cd68cab8fa0340a1797a72</a><br />Author:        Linus Torvalds &lt;torvalds&#64;linux-foundation.org&gt;<br />AuthorDate:    Wed, 28 Aug 2019 10:56:48 +02:00<br />Committer:     Ingo Molnar &lt;mingo&#64;kernel.org&gt;<br />CommitterDate: Wed, 28 Aug 2019 17:31:31 +02:00<br /><br />x86/build: Add -Wnoaddress-of-packed-member to REALMODE_CFLAGS, to silence GCC9 build warning<br /><br />One of the very few warnings I have in the current build comes from<br />arch/x86/boot/edd.c, where I get the following with a gcc9 build:<br /><br />   arch/x86/boot/edd.c: In function ‘query_edd’:<br />   arch/x86/boot/edd.c:148:11: warning: taking address of packed member of ‘struct boot_params’ may result in an unaligned pointer value [-Waddress-of-packed-member]<br />     148 |  mbrptr = boot_params.edd_mbr_sig_buffer;<br />         |           ^~~~~~~~~~~<br /><br />This warning triggers because we throw away all the CFLAGS and then make<br />a new set for REALMODE_CFLAGS, so the -Wno-address-of-packed-member we<br />added in the following commit is not present:<br /><br />  6f303d60534c ("gcc-9: silence 'address-of-packed-member' warning")<br /><br />The simplest solution for now is to adjust the warning for this version<br />of CFLAGS as well, but it would definitely make sense to examine whether<br />REALMODE_CFLAGS could be derived from CFLAGS, so that it picks up changes<br />in the compiler flags environment automatically.<br /><br />Signed-off-by: Linus Torvalds &lt;torvalds&#64;linux-foundation.org&gt;<br />Acked-by: Borislav Petkov &lt;bp&#64;alien8.de&gt;<br />Cc: Peter Zijlstra &lt;peterz&#64;infradead.org&gt;<br />Cc: Thomas Gleixner &lt;tglx&#64;linutronix.de&gt;<br />Signed-off-by: Ingo Molnar &lt;mingo&#64;kernel.org&gt;<br />---<br /> arch/x86/Makefile | 1 +<br /> 1 file changed, 1 insertion(+)<br /><br />diff --git a/arch/x86/Makefile b/arch/x86/Makefile<br />index 56e748a..94df086 100644<br />--- a/arch/x86/Makefile<br />+++ b/arch/x86/Makefile<br />&#64;&#64; -38,6 +38,7 &#64;&#64; REALMODE_CFLAGS	:= $(M16_CFLAGS) -g -Os -DDISABLE_BRANCH_PROFILING \<br /> <br /> REALMODE_CFLAGS += $(call __cc-option, $(CC), $(REALMODE_CFLAGS), -ffreestanding)<br /> REALMODE_CFLAGS += $(call __cc-option, $(CC), $(REALMODE_CFLAGS), -fno-stack-protector)<br />+REALMODE_CFLAGS += $(call __cc-option, $(CC), $(REALMODE_CFLAGS), -Wno-address-of-packed-member)<br /> REALMODE_CFLAGS += $(call __cc-option, $(CC), $(REALMODE_CFLAGS), $(cc_stack_align4))<br /> export REALMODE_CFLAGS<br /> <br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
