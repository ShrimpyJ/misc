    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2020/10/22/563">First message in thread</a></li><li><a href="/lkml/2020/11/27/723">Linus Torvalds</a><ul><li><a href="/lkml/2020/11/28/272">Masahiro Yamada</a><ul><li class="origin"><a href="/lkml/2020/12/1/1832">Linus Torvalds</a><ul><li><a href="/lkml/2020/12/1/1832">Kees Cook</a></li><li><a href="/lkml/2020/12/2/589">Masahiro Yamada</a><ul><li><a href="/lkml/2020/12/2/577">Masahiro Yamada</a></li><li><a href="/lkml/2020/12/2/1235">Linus Torvalds</a></li></ul></li></ul></li></ul></li></ul></li></ul><div class="threadlist">Patch in this message</div><ul class="threadlist"><li><a href="/lkml/diff/2020/11/28/207/1">Get diff 1</a></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Sat, 28 Nov 2020 10:28:31 -0800</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [GIT PULL 2/2] Kconfig updates for v5.10-rc1</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Fri, Nov 27, 2020 at 11:05 PM Masahiro Yamada &lt;masahiroy&#64;kernel.org&gt; wrote:<br />&gt;<br />&gt; As for the cc1plus cost, I got a similar result.<br />&gt;<br />&gt; Running scripts/gcc-plugin.sh directly<br />&gt; took me 0.5 sec, which is a fourth<br />&gt; of the allmodconfig run-time.<br />&gt;<br />&gt; Actually, I did not know this shell script<br />&gt; was so expensive to run...<br /><br />So it turns out that one reason it's so expensive to run is that it<br />does a *lot* more than it claims to do.<br /><br />It says "we need a c++ compiler that supports the designated<br />initializer GNU extension", but then it actually includes a header<br />file from hell, rather than just test designated initializers.<br /><br />This patch makes the cc1plus overhead go down a lot. That said, I'm<br />doubtful we really want gcc plugins at all, considering that the only<br />real users have all apparently migrated to clang builtin functionality<br />instead.<br /><br />        Linus<br /> scripts/gcc-plugin.sh | 2 +-<br /> 1 file changed, 1 insertion(+), 1 deletion(-)<br /><br />diff --git a/scripts/gcc-plugin.sh b/scripts/gcc-plugin.sh<br />index b79fd0bea838..59db87bff456 100755<br />--- a/scripts/gcc-plugin.sh<br />+++ b/scripts/gcc-plugin.sh<br />&#64;&#64; -8,8 +8,8 &#64;&#64; srctree=$(dirname "$0")<br /> gccplugins_dir=$($* -print-file-name=plugin)<br /> <br /> # we need a c++ compiler that supports the designated initializer GNU extension<br />+test -e "$gccplugins_dir/include/plugin-version.h" &amp;&amp;<br /> $HOSTCC -c -x c++ -std=gnu++98 - -fsyntax-only -I $srctree/gcc-plugins -I $gccplugins_dir/include 2&gt;/dev/null &lt;&lt;EOF<br />-#include "gcc-common.h"<br /> class test {<br /> public:<br /> 	int test;</pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
