    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2020/10/29/1392">First message in thread</a></li><li><a href="/lkml/2020/10/29/1435">Thomas Gleixner</a><ul><li><a href="/lkml/2020/10/30/319">Thomas Gleixner</a><ul><li class="origin"><a href="/lkml/2020/10/30/1226">Linus Torvalds</a><ul><li><a href="/lkml/2020/10/30/1226">Thomas Gleixner</a><ul><li><a href="/lkml/2020/10/30/1249">Linus Torvalds</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Fri, 30 Oct 2020 13:28:24 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [patch V2 00/18] mm/highmem: Preemptible variant of kmap_atomic &amp; friends</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Fri, Oct 30, 2020 at 2:39 AM Thomas Gleixner &lt;tglx&#64;linutronix.de&gt; wrote:<br />&gt;<br />&gt; But then we really should not name it kmap_local. 'local' suggests<br />&gt; locality, think local_irq*, local_bh* ... kmap_task would be more<br />&gt; accurate then.<br /><br />So the main reason I'd like to see it is because I think on a<br />non-highmem machine, the new kmap should be a complete no-op. IOW,<br />we'd make sure that there are no costs, no need to increment any<br />"restrict migration" counts etc.<br /><br />It's been a bit of a pain to have kmap_atomic() have magical side<br />semantics that people might then depend on.<br /><br />I think "local" could still work as a name, because it would have to<br />be thread-local (and maybe we'd want a debug mode where that gets<br />verified, as actual HIGHMEM machines are getting rare).<br /><br />I'd avoid "task", because that implies (to me, at least) that it<br />wouldn't be good for interrupts etc that don't have a task context.<br /><br />I think the main issue is that it has to be released in the same<br />context as it was created (ie no passing those things around to other<br />contexts). I think "local" is fine for that, but I could imagine other<br />names. The ones that come to mind are somewhat cumbersome, though<br />("shortterm" or "local_ctx" or something along those lines).<br /><br />I dunno.<br /><br />              Linus<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
