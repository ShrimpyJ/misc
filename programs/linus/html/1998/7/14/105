    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/1998/7/11/24">First message in thread</a></li><li><a href="/lkml/1998/7/14/99">Linus Torvalds</a><ul><li><a href="/lkml/1998/7/14/101">Alex Buell</a><ul><li class="origin"><a href="/lkml/1998/7/14/109">Linus Torvalds</a><ul><li><a href="/lkml/1998/7/14/109">Alex Buell</a><ul><li><a href="/lkml/1998/7/14/112">Geert Uytterhoeven</a></li><li><a href="/lkml/1998/7/14/113">David Lang</a></li><li><a href="/lkml/1998/7/14/122">"Aaron J. Grier"</a></li><li><a href="/lkml/1998/7/15/1">"Bruce A. Locke"</a></li></ul></li></ul></li><li><a href="/lkml/1998/7/14/121">Gerhard Mack</a><ul><li><a href="/lkml/1998/7/14/138">Alex Buell</a></li></ul></li></ul></li><li><a href="/lkml/1998/7/14/119">MOLNAR Ingo</a></li><li><a href="/lkml/1998/7/15/3">Gerard Roudier</a><ul><li><a href="/lkml/1998/7/15/84">Linus Torvalds</a><ul><li><a href="/lkml/1998/7/15/111">Gerard Roudier</a><ul><li><a href="/lkml/1998/7/15/113">Linus Torvalds</a></li></ul></li><li><a href="/lkml/1998/7/19/74">Rik van Riel</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Tue, 14 Jul 1998 14:23:56 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: Strange interrupt behaviour</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Tue, 14 Jul 1998, Alex Buell wrote:<br />&gt; <br />&gt; Ok, we get the point. I've just had a thought - what if the problems we've<br />&gt; been seeing with the memory allocation/defragmentation issues are unique<br />&gt; to low memory machines? If that is the case, then maybe we should have a<br />&gt; _different_ algorithm for handling these low memory machines (use 2.0.x<br />&gt; algorithms?), and keep the existing one for boxes with plenty of memory.<br /><br />Yes.<br /><br />This is actually one thing that surprised me when I did the math myself. <br />My own intuition had actually been that it shouldn't matter how much<br />memory you have, as long as you keep some fixed percentage "x" free of<br />that memory.<br /><br />And I think this is what tripped me, and it was very illuminating for me<br />to look at the actual numbers. They showed clearly that the likelihood for<br />finding consecutive pages was _not_ a function of the percentage of free<br />pages. It's very sensitive indeed to how much memory you have total, and<br />it's fairly non-linear. <br /><br />It makes perfect sense when I actually look at the math, but I had gone<br />purely on intuition, and I think this is partly why I've been so happy<br />with 2.1.x, but others have been trying to patch around things in it to<br />hide problems they had on smaller memory machines. So trying to convince<br />others that buddy and random is ok definitely showed a hole in my own<br />intuition also.<br /><br />Just in case you're interested, I'll append my generated table. The<br />percentage number is the probability for not finding a 8kB allocation with<br />those particular parameters..<br /><br />Anyway, looking at the table it is fairly obvious why machines with much<br />memory don't tend to have problems.. <br /><br />		Linus<br /><br />-----<br />[torvalds&#64;penguin torvalds]$ ./a.out <br />  X =   1024, Y =     20 (  4MB,  2% free) = 68.6673%<br />  X =   1024, Y =     51 (  4MB,  5% free) =  7.6047%<br />  X =   1024, Y =     81 (  4MB,  8% free) =  0.1245%<br /><br />  X =   2048, Y =     40 (  8MB,  2% free) = 46.2224%<br />  X =   2048, Y =    102 (  8MB,  5% free) =  0.5488%<br />  X =   2048, Y =    163 (  8MB,  8% free) =  0.0001%<br /><br />  X =   4096, Y =     81 ( 16MB,  2% free) = 20.1256%<br />  X =   4096, Y =    204 ( 16MB,  5% free) =  0.0029%<br />  X =   4096, Y =    327 ( 16MB,  8% free) =  0.0000%<br /><br />  X =   8192, Y =    163 ( 32MB,  2% free) =  3.8125%<br />  X =   8192, Y =    409 ( 32MB,  5% free) =  0.0000%<br />  X =   8192, Y =    655 ( 32MB,  8% free) =  0.0000%<br /><br />  X =  16384, Y =    327 ( 64MB,  2% free) =  0.1368%<br />  X =  16384, Y =    819 ( 64MB,  5% free) =  0.0000%<br />  X =  16384, Y =   1310 ( 64MB,  8% free) =  0.0000%<br /><br />  X =  32768, Y =    655 (128MB,  2% free) =  0.0002%<br />  X =  32768, Y =   1638 (128MB,  5% free) =  0.0000%<br />  X =  32768, Y =   2621 (128MB,  8% free) =  0.0000%<br /><br />  X =  65536, Y =   1310 (256MB,  2% free) =  0.0000%<br />  X =  65536, Y =   3276 (256MB,  5% free) =  0.0000%<br />  X =  65536, Y =   5242 (256MB,  8% free) =  0.0000%<br /><br /><br />-<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.rutgers.edu<br />Please read the FAQ at <a href="http://www.altern.org/andrebalsa/doc/lkml-faq.html">http://www.altern.org/andrebalsa/doc/lkml-faq.html</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
