    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/1998/7/26/57">First message in thread</a></li><li><a href="/lkml/1998/7/26/57">Andrew Derrick Balsa</a><ul><li><a href="/lkml/1998/7/26/63">(Alan Cox)</a><ul><li><a href="/lkml/1998/7/26/68">Dustin Marquess</a></li><li><a href="/lkml/1998/7/26/77">Andrew Derrick Balsa</a></li></ul></li><li class="origin"><a href="/lkml/1998/7/26/106">(Linus Torvalds)</a><ul><li><a href="/lkml/1998/7/26/106">"David S. Miller"</a></li></ul></li><li><a href="/lkml/1998/7/26/129"> rodgerd&#64;ihug ...</a><ul><li><a href="/lkml/1998/7/26/140">(Alan Cox)</a><ul><li><a href="/lkml/1998/7/26/150"> bytor&#64;tucka ...</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">(Linus Torvalds)</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: 2.1.111: IDE DMA disabled?</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">26 Jul 1998 21:21:11 GMT</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">In article &lt;35BB88B9.3DC25904&#64;altern.org&gt;,<br />Andrew Derrick Balsa  &lt;andrebalsa&#64;altern.org&gt; wrote:<br />&gt;Hi,<br />&gt;<br />&gt;On Sun, 26 Jul 1998, Linus Torvalds wrote:<br />&gt;&gt; <br />&gt;&gt; I don't buy into the BIOS argument. I've heard it before, and it sounds<br />&gt;&gt; completely bogus to me. If you're running Win3.11, the BIOS will have done<br />&gt;&gt; the same thing, and I know win3.11 doesn't use DMA in its native driver. <br />&gt;&gt; And I bet they tested that configuration. In short, whoever came up with<br />&gt;&gt; the argument that "if the BIOS tells us that it can do DMA, we must follow<br />&gt;&gt; that" is just out to lunch or is trying to reach for any reason to keep it<br />&gt;&gt; enabled.<br />&gt;<br />&gt;I have yet to come across a Win 3.11/DOS IDE (U)DMA driver, please point<br />&gt;me to one.<br /><br />Umm, I think you missed the point.<br /><br />My point was _exactly_ that the 3.11 drivers do NOT use (U)DMA, yet they<br />obviously are expected to work anyway.<br /><br />So whatever the BIOS does to enabled (U)DMA does not _require_ that you<br />use (U)DMA.  A driver that choses to ignore DMA will work correctly, and<br />the argument that the BIOS has set up some internal registers for DMA<br />does _not_ mean that you have to use DMA only because the BIOS tells you<br />it has set it up. <br /><br />&gt;What you will see are Windows 95 DMA Bus Mastering drivers. Those set<br />&gt;safe timings which might not be available from the BIOS initialization<br />&gt;routines.<br /><br />Again, this is exactly my point.  We're being too aggressive by default:<br />we use DMA (even though we don't have to), and we probably use fairly<br />aggressive DMA timing settings too, judging by some of the code in the<br />ide drivers (grep for "bus_speed", for example, and notice how a comment<br />says that a system_bus_speed setting of 40 is "safe" on PCI.  It's<br />nowhere close to safe - if we assume that the system bus speed is 40 and<br />it really is 66MHz PCI, we're now completely off). <br /><br />&gt;Most recent BIOSes report this in their boot message. They may also be<br />&gt;setting timing parameters for (U)DMA transfers. I can give you at least<br />&gt;one example: the ASUS SP-97V motherboard.<br /><br />So? Who tested those timing parameters? Let me suspect that the<br />parameters were tested on a Win95 system where both the memory bus and<br />the PCI bus are essentially idle durint all disk transfers..  Especially<br />as win95 isn't exactly known for having blazingly fast disk IO, so the<br />timings weren't even verified under very heavy load, were they?<br /><br />So are you willing to guarantee that the timings are safe if there is<br />something else going on in the system? <br /><br />So I suspect we're too aggressive. <br /><br />Btw, if you assume that BIOS writers know what they are doing, you<br />should think twice.  They make sure it works under DOS and Windows, and<br />very very little else.  The same is true of the people that put the<br />machines together - at _no_ point in time is there generally anybody who<br />actually looks at the physical timings. <br /><br />			Linus<br /><br />-<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.rutgers.edu<br />Please read the FAQ at <a href="http://www.altern.org/andrebalsa/doc/lkml-faq.html">http://www.altern.org/andrebalsa/doc/lkml-faq.html</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
