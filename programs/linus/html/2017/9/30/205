    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2017/9/20/939">First message in thread</a></li><li><a href="/lkml/2017/9/20/939">kernel test robot</a><ul><li><a href="/lkml/2017/9/30/63">NeilBrown</a><ul><li class="origin"><a href="/lkml/2017/10/9/104">Linus Torvalds</a><ul><li><a href="/lkml/2017/10/9/104">Ye Xiaolong</a></li><li><a href="/lkml/2017/10/9/739">Tejun Heo</a><ul><li><a href="/lkml/2017/10/12/903">Ye Xiaolong</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Sat, 30 Sep 2017 13:21:13 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [lkp-robot] [blk] 47e0fb461f: BUG:unable_to_handle_kernel</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Thu, Sep 21, 2017 at 12:02 AM, NeilBrown &lt;neilb&#64;suse.com&gt; wrote:<br />&gt;<br />&gt; I think it is crashing in<br />&gt; static inline bool ata_is_host_link(const struct ata_link *link)<br />&gt; {<br />&gt;         return link == &amp;link-&gt;ap-&gt;link || link == link-&gt;ap-&gt;slave_link;<br />&gt; }<br /><br />Yes. The code is<br /><br />  1a: 8b 3a                mov    (%edx),%edi<br />  1c: 8d 8f 40 16 00 00    lea    0x1640(%edi),%ecx<br />  22: 39 ca                cmp    %ecx,%edx<br />  24: 74 49                je     0x6f<br />  26: b9 01 00 00 00        mov    $0x1,%ecx<br />  2b:* 39 97 80 24 00 00    cmp    %edx,0x2480(%edi) &lt;-- trapping instruction<br />  31: 74 3c                je     0x6f<br /><br />and that first "je" is the test for "link == &amp;link-&gt;ap-&gt;link" (which<br />only takes the address relative to "link-&gt;ap" - thus the "lea"), and<br />that cmp that oopses is indeed loading that actual slave_link value.<br /><br />So I agree. "link-&gt;ap" is NULL for some odd reason.<br /><br />Hmm. Absolutely nothing has changed in libata-core.c recently,<br />certainly not that async_port_probe() thing.<br /><br />So I suspect either it's just a timing difference, or it's some<br />unrelated memory corruption.<br /><br />Xiaolong, I see that you have SLUB_DEBUG and SLUB_DEBUG_ON enabled,<br />but wonder if you can recreate this with DEBUG_PAGEALLOC and/or<br />DEBUG_OBJECTS enabled too?<br /><br />Tejun, any ideas? The original report is at<br /><br />   <a href="https://lkml.org/lkml/2017/9/20/939">https://lkml.org/lkml/2017/9/20/939</a><br /><br />in case you don't see it in your inbox from lkml.<br /><br />                       Linus<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
