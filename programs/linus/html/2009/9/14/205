    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2009/9/4/357">First message in thread</a></li><li><a href="/lkml/2009/9/12/148">Eric Paris</a><ul><li><a href="/lkml/2009/9/13/112">Eric Paris</a></li><li><a href="/lkml/2009/9/14/47">Ingo Molnar</a><ul><li><a href="/lkml/2009/9/14/58">Pekka Enberg</a><ul><li><a href="/lkml/2009/9/14/80">Jens Axboe</a><ul><li><a href="/lkml/2009/9/14/82">Pekka Enberg</a></li></ul></li></ul></li><li class="origin"><a href="/lkml/2009/9/14/254">Linus Torvalds</a><ul><li><a href="/lkml/2009/9/14/254">"Paul E. McKenney"</a><ul><li><a href="/lkml/2009/9/14/276">Jens Axboe</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Mon, 14 Sep 2009 07:40:27 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [origin tree SLAB corruption] BUG kmalloc-64: Poison overwritten, INFO: Allocated in bdi_alloc_work+0x2b/0x100 age=175 cpu=1 pid=3514</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Mon, 14 Sep 2009, Ingo Molnar wrote:<br />&gt; <br />&gt; BUG kmalloc-64: Poison overwritten<br />&gt; -----------------------------------------------------------------------------<br />&gt; <br />&gt; INFO: 0xf498f6a0-0xf498f6a7. First byte 0x90 instead of 0x6b<br />&gt; INFO: Allocated in bdi_alloc_work+0x2b/0x100 age=175 cpu=1 pid=3514<br />&gt; INFO: Freed in bdi_work_free+0x45/0x60 age=9 cpu=1 pid=3509<br />&gt; INFO: Slab 0xc3257d84 objects=36 used=11 fp=0xf498f690 flags=0x400000c3<br />&gt; INFO: Object 0xf498f690 &#64;offset=1680 fp=0xf498fe00<br />&gt; <br />&gt; Bytes b4 0xf498f680:  ab 0d 00 00 9c 27 ff ff 5a 5a 5a 5a 5a 5a 5a 5a ?....'??ZZZZZZZZ<br />&gt;   Object 0xf498f690:  6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk<br />&gt;   Object 0xf498f6a0:  90 f3 98 f4 60 3c 11 c1 6b 6b 6b 6b 6b 6b 6b 6b .?.?`&lt;.?kkkkkkkk<br /><br />That's 8 bytes of 0xf498f398 and 0xc1113c60. Doesn't look like much, but <br />they're both valid kernel pointers, and the 0xf498f398 one is actually <br />into the same page as the corruption, so it's a pointer to the same slab <br />type (or at least same size). Which is a good hint in itself: we're <br />looking at a list or something.<br /><br />And it's at offset 16 in the structure. <br /><br />That's almost certainly a "struct bdi_work", and the use-aftr-free thing <br />is the "struct rcu_head rcu_head" part of it. That first thing (pointer to <br />the same page) is 'next', and the second thing is a pointer to kernel text <br />(and I can pretty much guarantee that 0xc1113c60 is 'bdi_work_free').<br /><br />So this is either a fs/fs-writeback.c bug, or it's a problem with RCU. <br />Both of them are new or hugely changed since 2.6.31.<br /><br />			Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
