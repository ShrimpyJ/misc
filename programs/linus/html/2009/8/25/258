    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2009/8/24/238">First message in thread</a></li><li><a href="/lkml/2009/8/24/303">Eric Paris</a><ul><li><a href="/lkml/2009/8/25/170">"Mikko C."</a><ul><li><a href="/lkml/2009/8/25/221">Eric Paris</a></li><li class="origin"><a href="/lkml/2009/8/25/266">Linus Torvalds</a><ul><li><a href="/lkml/2009/8/25/266">"Mikko C."</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Tue, 25 Aug 2009 09:43:47 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [PATCH 2/3] inotify: do not BUG on idr entries at inotify destruction</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Tue, 25 Aug 2009, Mikko C. wrote:<br />&gt; <br />&gt; I just got this with -rc7, but it doesn't look related to what I was having<br />&gt; before:<br />&gt; <br />&gt; BUG: Bad page map in process kio_thumbnail  pte:ffff88006cc99128 pmd:6d3b1067<br />&gt; addr:00007f9d4e3a5000 vm_flags:08000070 anon_vma:(null)<br />&gt; mapping:ffff88007abe21a0 index:200<br />&gt; vma-&gt;vm_ops-&gt;fault: filemap_fault+0x0/0x460<br />&gt; vma-&gt;vm_file-&gt;f_op-&gt;mmap: ext4_file_mmap+0x0/0x80<br />&gt; Pid: 28022, comm: kio_thumbnail Not tainted 2.6.31-rc7 #1<br />&gt; Call Trace:<br />&gt;  [&lt;ffffffff810afaf4&gt;] ? print_bad_pte+0x1d4/0x2c0<br />&gt;  [&lt;ffffffff810afc79&gt;] ? vm_normal_page+0x99/0xa0<br />&gt;  [&lt;ffffffff810b0c7d&gt;] ? unmap_vmas+0x4cd/0x970<br />&gt;  [&lt;ffffffff810b6c74&gt;] ? exit_mmap+0x104/0x1d0<br />&gt;  [&lt;ffffffff81043e0d&gt;] ? mmput+0x4d/0x100<br />&gt;  [&lt;ffffffff81048d81&gt;] ? exit_mm+0x101/0x150<br />&gt;  [&lt;ffffffff8104b240&gt;] ? do_exit+0x6c0/0x750<br />&gt;  [&lt;ffffffff8104b326&gt;] ? do_group_exit+0x56/0xd0<br />&gt;  [&lt;ffffffff8104b3c2&gt;] ? sys_exit_group+0x22/0x40<br />&gt;  [&lt;ffffffff8100b7eb&gt;] ? system_call_fastpath+0x16/0x1b<br />&gt; Disabling lock debugging due to kernel taint<br />&gt; <br />&gt; No lockups or anything.<br /><br />That looks like a memory corruption bug. Your page table entry is bad: <br />pte:ffff88006cc99128. It has the "special" bit set (one of the software <br />bits), in a mapping that should not have special pages.<br /><br />But that pte entry is odd in other ways too - it's _PAGE_PROTNONE, which <br />is unusual (but not necessarily _wrong_) and _PAGE_BIT_ACCESSED. And it <br />has the high bits set, which is really not ok for a page table entry. The <br />PTE entry should look more like the pmd entry.<br /><br />So it looks like the pte has been overwritten by some bogus value, <br />presumably by a stale pointer. And it migth be related to your inotify <br />problems that way.<br /><br />		Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
