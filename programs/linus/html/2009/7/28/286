    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2009/7/23/289">First message in thread</a></li><li><a href="/lkml/2009/7/28/243">Linus Torvalds</a><ul><li><a href="/lkml/2009/7/28/282">Alan Cox</a><ul><li class="origin"><a href="/lkml/2009/7/28/291">Linus Torvalds</a><ul><li><a href="/lkml/2009/7/28/291">Linus Torvalds</a><ul><li><a href="/lkml/2009/7/28/299">Alan Cox</a></li></ul></li><li><a href="/lkml/2009/7/28/298">Alan Cox</a><ul><li><a href="/lkml/2009/7/28/356">Linus Torvalds</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Tue, 28 Jul 2009 09:49:14 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [PATCH] kdesu broken</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Tue, 28 Jul 2009, Alan Cox wrote:<br />&gt; <br />&gt; We don't ignore it.<br /><br />Yes we do. Look at Ogawa-san's patch. And read my email answer to it.<br /><br />&gt; What goes in one end comes out the other after tty<br />&gt; processing (ldisc, echo etc). Reliably. Both the EOF fix and the<br />&gt; tty-&gt;low_latency fix cure that. [The low latency one also provides the<br />&gt; *exact* same semantics as we had prior to 2.6.31-rc as well]<br /><br />I agree that the low-latency thing should fix things, and I applied it. <br />But I think that Ogawa's patch is fundamentally "correct" at a much higher <br />level. Rather than depend on low-latency being set, it just "Does The <br />Right Thing(tm)", by making sure that readers never even look at the EOF <br />bits etc until they have flushed the tty ldisc state.<br /><br />&gt; If I understand Ogawa correctly then what emacs thinks is true is quite<br />&gt; different: Emacs thinks that<br />&gt; <br />&gt; 	write(pty, "data", length)<br />&gt; 	close(pty)<br />&gt; 	exit()<br />&gt; <br />&gt; will always ensure that the other end has already got the data before<br />&gt; close() completes - or to be more exact before the parent receives SIGCLD.<br /><br />.. and depending on what emacs does with signals and it's select() loop, <br />that may actually be _entirely_reasonable_.<br /><br />Imagine being in 'select()' (or read, for that matter), and getting EINTR <br />due to SIGCHLD. What is the correct expectations?<br /><br />The correct expectation is that the select() (or read()) should have <br />returned any data that it saw _before_ it returns EINTR.<br /><br />		Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
