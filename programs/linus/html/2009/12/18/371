    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2009/12/18/247">First message in thread</a></li><li><a href="/lkml/2009/12/18/247">Ingo Molnar</a><ul><li><a href="/lkml/2009/12/18/254">Dave Hansen</a><ul><li><a href="/lkml/2009/12/18/257">Ingo Molnar</a><ul><li><a href="/lkml/2009/12/18/337">Dave Hansen</a></li></ul></li></ul></li><li class="origin"><a href="">Linus Torvalds</a></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Fri, 18 Dec 2009 12:10:35 -0800 (PST)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: -tip: origin tree boot crash</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Fri, 18 Dec 2009, Ingo Molnar wrote:<br />&gt; [   75.151208] calling  nas_gpio_init+0x0/0x153 &#64; 1<br />&gt; [   75.155860] BUG: unable to handle kernel paging request at 00000000001de7d0<br />&gt; [   75.159841] IP: [&lt;ffffffff81683c55&gt;] strstr+0x20/0x5f<br /><br />Ok, the disassembly is<br /><br />   b:	55                   	push   %rbp<br />   c:	48 89 f2             	mov    %rsi,%rdx<br />   f:	48 89 e5             	mov    %rsp,%rbp<br />  12:	eb 03                	jmp    0x17<br />  14:	48 ff c2             	inc    %rdx<br />  17:	80 3a 00             	cmpb   $0x0,(%rdx)<br />  1a:	75 f8                	jne    0x14<br />  1c:	29 f2                	sub    %esi,%edx<br />  1e:	48 89 f8             	mov    %rdi,%rax<br />  21:	74 45                	je     0x68<br />  23:	48 89 f9             	mov    %rdi,%rcx<br />  26:	eb 03                	jmp    0x2b<br />  28:	48 ff c1             	inc    %rcx<br />  2b:*	80 39 00             	cmpb   $0x0,(%rcx)     &lt;-- trapping instruction<br />  2e:	75 f8                	jne    0x28<br />  30:	48 89 f8             	mov    %rdi,%rax<br />  33:	4c 63 d2             	movslq %edx,%r10<br />  36:	eb 26                	jmp    0x5e<br /><br />so if I read that code right, that's a 'strlen()' on %rdi, which is the <br />first argument to strstr().<br /><br />So it would be that <br /><br />	l1 = strlen(s1);<br /><br />thing, and 's1' is bad.<br /><br />Which in turn means:<br /><br />&gt; [   75.159841] Call Trace:<br />&gt; [   75.159841]  [&lt;ffffffff825f0dfb&gt;] dmi_matches+0x6f/0x8d<br /><br />that since the call is<br /><br />	strstr(dmi_ident[s], dmi-&gt;matches[i].substr)<br /><br />that it is the "dmi_ident[]" array itself that is broken.<br /><br />The DMI code doesn't seem to be very careful about checking the array <br />accesses against DMI_STRING_MAX. So I wonder if this is actually a DMI <br />bug, not a driver bug - and that the driver just is able to trigger that <br />bug somehow where others have not.<br /><br />		Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
