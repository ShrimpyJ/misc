    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2018/8/14/686">First message in thread</a></li><li><a href="/lkml/2018/8/15/407">Sebastian Gottschall</a><ul><li><a href="/lkml/2018/8/15/420">Guenter Roeck</a><ul><li class="origin"><a href="/lkml/2018/8/15/463">Linus Torvalds</a><ul><li><a href="/lkml/2018/8/15/463">Sebastian Gottschall</a><ul><li><a href="/lkml/2018/8/15/482">Linus Torvalds</a></li></ul></li><li><a href="/lkml/2018/8/15/479">Guenter Roeck</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Wed, 15 Aug 2018 12:42:27 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [PATCH 4.9 000/107] 4.9.120-stable review</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Wed, Aug 15, 2018 at 12:26 PM Guenter Roeck &lt;linux&#64;roeck-us.net&gt; wrote:<br />&gt;<br />&gt; Also seen in mainline. Meaning my non-SMP test builds are broken. Hmm.<br /><br />Grr. I think it's due mainly due to commit 447ae3166702 ("x86: Don't<br />include linux/irq.h from asm/hardirq.h"), which exposes a number of<br />files that had some dodgy include file dependenencies, and just<br />randomly happened to get it right because of that odd include that<br />caused problems.<br /><br />That commit itself is definitely the right thing to do, but yes, we<br />clearly had a lot of cases of things getting core header files<br />included purely by luck.<br /><br />And because this was all done under embargo, we didn't get the kind of<br />test robot coverage we usually get.<br /><br />Part of it can also be due to subtle merge issues - even if the<br />original branch got good coverage, later changes sometimes ended up<br />adding things like that.<br /><br />For example, my merge of the L1TF code found that in the meantime,<br />arch/x86/kernel/kvmclock.c had added a call to kzalloc(), which used<br />to work just fine, but with the header cleanup it turned out that<br />kvmclock.c had never included &lt;linux/slab.h&gt;, so now it didn't build<br />right.<br /><br />And that was just the one I noticed because of my limited build tests.<br /><br />And yes, every single developer has CONFIG_SMP in their config, but<br />perhaps equally importantly, I suspect CONFIG_SMP ends up getting more<br />header files included almost by mistake, so it can _continue_ to hide<br />these kinds of incomplete header file includes that just happen to<br />work.<br /><br />&gt; Anyway, care to send a proper patch ? I am sure Linus will be more<br />&gt; than happy to apply it.<br /><br />I think "happy" is too strong a word for my state of mind with all<br />this, but yes, I'll apply it, and you'll get the glory of fixing some<br />configuration that clearly didn't get properly tested.<br /><br />In the meantime, maybe I should just do a "make allmodconfig" and then<br />disable SMP and see if that shows anything for me.<br /><br />              Linus<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
