    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2018/11/2/106">First message in thread</a></li><li><a href="/lkml/2018/12/21/22">Christoph Hellwig</a><ul><li><a href="/lkml/2018/12/21/197">Richard Weinberger</a></li><li><a href="/lkml/2018/12/21/415">"Theodore Y. Ts'o"</a><ul><li><a href="/lkml/2018/12/21/417">Matthew Wilcox</a><ul><li><a href="/lkml/2018/12/21/451">"Theodore Y. Ts'o"</a><ul><li><a href="/lkml/2018/12/21/472">Matthew Wilcox</a></li></ul></li></ul></li><li class="origin"><a href="/lkml/2018/12/22/218">Linus Torvalds</a><ul><li><a href="/lkml/2018/12/22/218">"Theodore Y. Ts'o"</a><ul><li><a href="/lkml/2018/12/22/227">Linus Torvalds</a></li><li><a href="/lkml/2019/1/4/532">Daniel Colascione</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Fri, 21 Dec 2018 11:13:07 -0800</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [PATCH v2 01/12] fs-verity: add a documentation file</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Fri, Dec 21, 2018 at 7:47 AM Theodore Y. Ts'o &lt;tytso&#64;mit.edu&gt; wrote:<br />&gt;<br />&gt; Linus --- we're going round and round, and I don't think this is<br />&gt; really a technical dispute at this point, but rather an aesthetics<br />&gt; one.<br /><br />Grr.<br /><br />So honestly, I personally *like* the model of "the file contains its<br />own validation data" model. I think that's the right model, so that<br />you can then basically just do "enable verification on this file, and<br />verify that the root hash is this".<br /><br />So that part I like. I think the people who argue for "let's have a<br />separate interface that writes the merkle tree data" are completely<br />wrong.<br /><br />HOWEVER.<br /><br />I do agree that your particular model is pretty damn broken in lots of ways.<br /><br />Why is it filesystem specific? If the whole point is that the file<br />itself has its own verification data (which I like), then I don't see<br />why this is then documented as some filesystem-specific layout model.<br />That's complete and utter garbage.<br /><br />In other words: either the model is that the file *itself* contains<br />its own merkle tree that validates the file, or it isn't. You can't<br />have it two ways. No silly "layout changes when you apply the hash"<br />garbage. That's just crazy talk and invalidates the whole model.<br /><br />And honestly, I still think that it's very odd to add the merge data<br />to the end, when the filesystem already supports xattrs. It would have<br />made much more sense to just make one xattr contain the merkle tree<br />validation data.<br /><br />So why is this sold as some unholy mess of "filesystem-specific" and<br />"generic"? That part just annoys the hell out of me. Why isn't this<br />sold as an *actual* generic model, where you just say "append the<br />merkle tree to the file, then enable verity testing of the end result<br />and validate the top-level hash".<br /><br />That kind of thing could be done with absolutely _zero_ per-filesystem<br />code, and made 100% generic, and we'd just verify the merge data in<br />readpages().<br /><br />So what's the excuse for doing the crazy odd "let's just support one<br />single filesystem" model?<br /><br />                    Linus<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
