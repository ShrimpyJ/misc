    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/1997/7/12/62">First message in thread</a></li><li><a href="/lkml/1997/7/13/69">Bill Hawes</a><ul><li><a href="/lkml/1997/7/14/32">Linus Torvalds</a><ul><li class="origin"><a href="/lkml/1997/7/15/34">Linus Torvalds</a><ul><li><a href="/lkml/1997/7/15/34">Bill Hawes</a></li></ul></li><li><a href="/lkml/1997/7/15/24">NIIBE Yutaka</a></li><li><a href="/lkml/1997/7/16/88">(Matthias Urlichs)</a><ul><li><a href="/lkml/1997/7/14/37">(Matthias Urlichs)</a><ul><li><a href="/lkml/1997/7/16/94">linux kernel account</a></li></ul></li><li><a href="/lkml/1997/7/16/38">Gerd Knorr</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js"></script><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Sun, 13 Jul 1997 21:34:12 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: pre-patch2.1.45-3 lookin' good</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />Ok, I've now gotten the garbage collection working the way I want it to<br />work, and generally cleaned up the dentry usage so that there are no<br />circular dependencies between dentries and inodes.  Some of the code still<br />needs to be cleaned up a bit, but I _think_ that the basics are ok. <br /><br />The code is in "pre-patch-2.1.45-4.gz", patch relative to a clean 2.1.44.<br />It still doesn't do unmounting etc cleanly, but with this code the unmount<br />testing _should_ be something like<br /><br />	shrink_dcache(0);<br />	if (sb-&gt;s_root-&gt;d_count != some_constant_I_think_it_s_four)<br />		return -EBUSY;<br />	.. ok, we can unmount ..<br /><br />so it shouldn't be all that hard to add.. I'm hoping that somebody will<br />re-do their patches for the new code-base, hint hint ;)<br /><br />Currently not working:<br /> - some of the binfmt loaders (java and misc). It's reasonably<br />   straightforward to fix them, but I only fixed the ones I actually have<br />   enabled (it took me pretty much all of today to fix everything, and I'm<br />   simply too exhausted to worry about details any more). <br /> - rd_root initial ramdisk loading. The file pointer initializations are<br />   more complex, and I can't stomach it right now - again I don't actually<br />   use this feature.<br /> - unmount/remount is still broken.<br /> - probably other stuff that I simply haven't tested.<br /><br />But the garbage collection driven by low memory conditions seems to work,<br />and it all "feels" much better than it used to (note that when I say<br />something "feels good" it doesn't necessarily mean that it is usable, it<br />mainly means that I think all the basic approaches are fine and while<br />there may be a lot of details to clean up they really are only details). <br /><br />In short, I think the major overhaul is done, and the code basically<br />works. There are quirks and missing stuff still, but I just know/hope that<br />there are people out there that find it all the more interesting because<br />of that. <br /><br />Comments?<br /><br />		Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
