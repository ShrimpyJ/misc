    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/1997/7/10/69">First message in thread</a></li><li><a href="/lkml/1997/7/11/1">Linus Torvalds</a><ul><li><a href="/lkml/1997/7/11/28">(Alan Cox)</a><ul><li class="origin"><a href="/lkml/1997/7/12/13">Linus Torvalds</a><ul><li><a href="/lkml/1997/7/12/13">Rob van Nieuwkerk</a></li><li><a href="/lkml/1997/7/12/47">Rob van Nieuwkerk</a><ul><li><a href="/lkml/1997/7/13/28">"Theodore Y. Ts'o"</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Fri, 11 Jul 1997 08:59:13 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: PATCH to pre-patch-2.1.45: clean_inode needs to reset i_writecount</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Fri, 11 Jul 1997, Alan Cox wrote:<br />&gt;<br />&gt; &gt; The whole concept of "dtime" is _wrong_.<br />&gt; &gt; <br />&gt; &gt; Reason: it implies you have to write out the inode after deleting it. <br />&gt; &gt; Which is just stupid, plain and simple - if we have deallocated the inode<br />&gt; &gt; it by definition no longer contains any useful information, so we<br />&gt; &gt; shouldn't spend time writing it out to disk.<br />&gt; <br />&gt; I disagree with your  "definition" - it contains a clear statement the inode<br />&gt; isnt in use. That in iteself is useful information<br /><br />No.<br /><br />It _would_ be useful information if we didn't have that information<br />available to us through other means already. The reason the filesystem has<br />a inode bitmap is because the filesystem isn't so stupid that it would<br />want to read all inodes to see which ones are in use. So why are people<br />arguing that fsck should be that stupid? <br /><br />Don't be stupid about this: _think_ about the issue for a while. <br /><br />We already have an indicator of whether the inode is in use: the bitmap. <br />So the _only_ excuse for writing out dtime/i_nlink after deletion is that<br />it would act as a confirmation of the deletion. With me so far?<br /><br />So if the _only_ use of the fields is as a confirmation, why do we write<br />out 128 bytes to disk? If people really think we need a backup for the<br />inode bitmap, wouldn't it be better to think of it as what it is: just a<br />backup for the inode bitmap. Am I the only one who thinks that 128 bytes<br />is overkill when it comes to backing up one bit of information? <br /><br />I find it especially ludicrous as that backup already exists: in the form<br />of the directory tree. So now we have _three_ copies of the same<br />information, and people still think that i_nlink is important?<br /><br />What about indirect block information? Or even data block information? We<br />have just one copy of that, and if that gets corrupted we've lost the<br />data. But no, people worry about n_link which definitely slows us down,<br />because they want to have a _third_ copy of the same information. My brain<br />hurts.<br /><br />Wake up, people.. Getting rid of dtime + the "n_link = 0" information<br />would not make the filesystem any less secure, but it _would_ make it<br />faster. <br /><br />		Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
