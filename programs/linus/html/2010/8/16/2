    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2010/8/15/111">First message in thread</a></li><li><a href="/lkml/2010/8/15/111">Linus Torvalds</a><ul><li><a href="/lkml/2010/8/15/113">Markus Trippelsdorf</a></li><li><a href="/lkml/2010/8/15/117">Dave Airlie</a><ul><li class="origin"><a href="/lkml/2010/8/16/9">Linus Torvalds</a><ul><li><a href="/lkml/2010/8/16/9">Dave Airlie</a></li></ul></li></ul></li><li><a href="/lkml/2010/8/16/3">Andy Lutomirski</a><ul><li><a href="/lkml/2010/8/16/8">Linus Torvalds</a><ul><li><a href="/lkml/2010/8/16/173">Andy Lutomirski</a><ul><li><a href="/lkml/2010/8/16/184">Adam Jackson</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Sun, 15 Aug 2010 21:01:57 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: Intel graphics CPU usage - SDVO detect bogosity?</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Sun, Aug 15, 2010 at 8:30 PM, Dave Airlie &lt;airlied&#64;redhat.com&gt; wrote:<br />&gt;<br />&gt; At least we should replace mdelay with msleep in those functions.<br /><br />How precise does the timing have to be? I think i2c is self-clocking,<br />so it's ok to see big skews? Becuase msleep() can be off by quite a<br />bit (mdelay can too, but it's _way_ more rare, and requires either a<br />preemptible kernel or serious interrupt activity).<br /><br />&gt; Can you get a boot with drm.debug=4?<br /><br />Sure. That results in a truncated dmesg (with a 128k buffer). The<br />thing seems to spew out something every ten seconds:<br /><br />  ...<br />  [  232.610044] [drm:intel_sdvo_debug_write], SDVOB: W: 0B<br />             (SDVO_CMD_GET_ATTACHED_DISPLAYS)<br />  [  232.624504] [drm:intel_sdvo_debug_response], SDVOB: R: 01 00<br />             (Success)<br />  [  232.624517] [drm:intel_sdvo_detect], SDVO response 1 0<br />  [  232.624524] [drm:intel_sdvo_debug_write], SDVOB: W: 7A 01<br />             (SDVO_CMD_SET_CONTROL_BUS_SWITCH)<br />  [  242.672044] [drm:intel_sdvo_debug_write], SDVOB: W: 0B<br />             (SDVO_CMD_GET_ATTACHED_DISPLAYS)<br />  [  242.686503] [drm:intel_sdvo_debug_response], SDVOB: R: 01 00<br />             (Success)<br />  [  242.686516] [drm:intel_sdvo_detect], SDVO response 1 0<br />  [  242.686523] [drm:intel_sdvo_debug_write], SDVOB: W: 7A 01<br />             (SDVO_CMD_SET_CONTROL_BUS_SWITCH)<br />  [  252.750044] [drm:intel_sdvo_debug_write], SDVOB: W: 0B<br />             (SDVO_CMD_GET_ATTACHED_DISPLAYS)<br />  [  252.764526] [drm:intel_sdvo_debug_response], SDVOB: R: 01 00<br />             (Success)<br />  [  252.764539] [drm:intel_sdvo_detect], SDVO response 1 0<br />  ...<br /><br />It looks like it takes about 15 ms each time.  But 15 ms each 10s<br />doesn't seem to be enough to account for the load average. Maybe it<br />gets synchronized with the timer tick or something, causing the load<br />average to look artificially inflated (it also doesn't match up with<br />kworker using 1%+ CPU time).<br /><br />So maybe there is something else going on. Maybe the load average<br />thing comes from some interaction with the new workqueue thing.<br /><br />I'll send the whole dmesg to you in a private message, I don't think<br />we want 128kB of crud on lkml.<br /><br />&gt; I wonder are we picking up a bad SDVO, the insane code retries 50 times<br />&gt; with a hard loop delay.<br /><br />Well, I'm not seeing any failures, but maybe those don't get printed out?<br /><br />                        Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
