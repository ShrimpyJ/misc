    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2010/12/21/290">First message in thread</a></li><li><a href="/lkml/2010/12/22/386">Linus Torvalds</a><ul><li><a href="/lkml/2010/12/23/11">Peter Stuge</a></li><li><a href="/lkml/2010/12/23/13">Dave Airlie</a></li><li><a href="/lkml/2010/12/23/76">Alex Riesen</a><ul><li class="origin"><a href="">Linus Torvalds</a></li></ul></li><li><a href="/lkml/2010/12/23/199">Jesse Barnes</a></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Thu, 23 Dec 2010 09:48:17 -0800</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [git pull] drm fixes</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Thu, Dec 23, 2010 at 1:32 AM, Alex Riesen &lt;raa.lkml&#64;gmail.com&gt; wrote:<br />&gt; On Thu, Dec 23, 2010 at 04:54, Linus Torvalds<br />&gt; &lt;torvalds&#64;linux-foundation.org&gt; wrote:<br />&gt;&gt; Why does that code need to figure out some LVDS clock from the BIOS?<br />&gt;&gt; Why can't the code look at the actual hardware state or similar, since<br />&gt;&gt; presumably the screen is on after boot. THAT we can rely on, since a<br />&gt;&gt; BIOS that doesn't initialize LVDS is not going to ever ship even as<br />&gt;&gt; pre-release.<br />&gt;<br />&gt; What if the system booted with it's display turned off? Like a closed<br />&gt; laptop lid or disconnected monitor?<br /><br />So then we might have to guess and even use the BIOS state for guessing.<br /><br />But what's so hard to understand about that word "guess"? That really<br />is what happens every single time you use some BIOS table. It's not<br />"look up". It's not "get the right data". It very much is all about<br />"guessing". The BIOS tables are invariably buggy, and have likely only<br />ever been tested with one particular version of Windows.<br /><br />And that's _especially_ true of something like VBIOS tables. They<br />haven't been tested even with windows, they have only been tested with<br />the particular graphics driver that the vendor shipped with that<br />machine. It's quite possible - even likely - that the graphics driver<br />hard-codes something.<br /><br />So think about it - if we boot with the laptop open, you have two<br />choices: "ask the hardware for real working state" or "guess by<br />probing random state from the BIOS that may or may not actually ever<br />be used that way by anything".<br /><br />Which choice would you pick?<br /><br />And if that means that some laptops have to be booted with the lid<br />open, that really isn't a problem.<br /><br />And yes, I do realize that VGA traditionally has had lots of hardware<br />state that is write-only and cannot be read back. It's possible that<br />this case is one of those. I dunno. I hope not.<br /><br />(Side note: resume is different from boot. You should test that resume<br />works with the lid closed, because resume state is not at all<br />guaranteed to be sane at all, lid or no lid. But the way to fix that<br />is NOT to ask the BIOS, it's to remember the state from the original<br />boot from before the suspend).<br /><br />                                  Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
