    </div></td><td width="32"> </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2010/11/21/74">First message in thread</a></li><li><a href="/lkml/2010/11/21/74">Pekka Enberg</a><ul><li class="origin"><a href="/lkml/2010/11/21/114">Linus Torvalds</a><ul><li><a href="/lkml/2010/11/21/114">Oleg Nesterov</a><ul><li><a href="/lkml/2010/11/21/118">Linus Torvalds</a><ul><li><a href="/lkml/2010/11/21/119">Oleg Nesterov</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Sun, 21 Nov 2010 09:42:57 -0800</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [PROBLEM] WARNING: at kernel/exit.c:910 do_exit</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Sun, Nov 21, 2010 at 7:35 AM, Pekka Enberg &lt;penberg&#64;kernel.org&gt; wrote:<br />&gt;<br />&gt; The following warning triggered on me while I was browsing the web:<br />&gt;<br />&gt;  <a href="https://twitpic.com/38vxxg">http://twitpic.com/38vxxg</a><br />&gt;<br />&gt; [ Click on the "Rotate photo" button for landscape version. ]<br />&gt;<br />&gt; It's<br />&gt;<br />&gt;        WARN_ON(atomic_read(&amp;tsk-&gt;fs_excl));<br />&gt;<br />&gt; in do_exit(). There was a prior oops in __pipe_free_info() called in<br />&gt; sys_recvmsg() paths that unfortunately scrolled away.<br /><br />That WARN_ON() is almost certainly due to the previous oops.<br /><br />The previous oops may have scrolled away, but you can see the<br />call-chain, since it's part of the later oops. Except the photo is<br />hard to read ;)<br /><br />In fact, you can see that there has been _two_ oopses before that. The<br />"free_pipe_info()" oops comes from the "do_exit()" path of the _first_<br />oops.<br /><br />So the original oops seems to be around here:<br /><br />   (*probably* oopsed in __scm_destroy)<br />   (the fd_install on the stack is likely from scm_detach_fds calling<br />it before calling __scm_destroy - just a stale pointer remaining on<br />the stack)<br />   scm_detach_fds<br />   unix_stream_recvmsg<br />   sock_recvmsg<br />   __sys_recvmsg<br />   sys_recvmsg<br /><br />which means that this is almost certainly in networking. Then, when<br />that oops caused us to die, do_exit() tried to clean up the state, and<br />_that_ caused us to oops again (now in free_pipe_info). That second<br />oops is the partial one you see. And then the _third_ oops is the one<br />you actually caught.<br /><br />The free_pipe_info() oops in turn must be because we passed in an<br />invalid "inode" pointer. It's almost certainly the "inode-&gt;i_pipe"<br />dereference, so inode was NULL or something. I don't see why that<br />would happen, but with a previous oops it's not necessarily clear that<br />there _is_ a reason.<br /><br />And who knows? It may be that the networking oops was due to some<br />other earlier problem that isn't part of this particular callchain and<br />that has long since scrolled away. I don't see any unix domain changes<br />since -rc1.<br /><br />                   Linus<br />--<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.kernel.org<br />More majordomo info at  <a href="http://vger.kernel.org/majordomo-info.html">http://vger.kernel.org/majordomo-info.html</a><br />Please read the FAQ at  <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
