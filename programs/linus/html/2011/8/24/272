    </div></td><td width="32"> </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2011/8/19/428">First message in thread</a></li><li><a href="/lkml/2011/8/19/428">=?utf-8?Q?Rog=C3=A9rio?= Brito</a><ul><li><a href="/lkml/2011/8/19/444">=?UTF-8?Q?Rog=C3=A9rio_Brito?=</a><ul><li class="origin"><a href="/lkml/2011/8/24/335">Linus Torvalds</a><ul><li><a href="/lkml/2011/8/24/335">=?UTF-8?Q?Rog=C3=A9rio_Brito?=</a><ul><li><a href="/lkml/2011/8/24/364">=?UTF-8?Q?Rog=C3=A9rio_Brito?=</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Wed, 24 Aug 2011 10:47:43 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [Bug 41622] [REGRESSION][BISECTED] Notebook crashes upon detecting the PCI subsystem with kernels &gt;= 2.6.24-rc7</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">2011/8/19 Rogério Brito &lt;rbrito&#64;ime.usp.br&gt;:<br />&gt;<br />&gt; Reverting the commit above with the patch below makes me able to<br />&gt; compile and run Linus's v3.1-rc2:<br /><br />Oh, I just noticed that the "revert" you did actually does way more than revert.<br /><br />&gt; diff --cc drivers/pci/setup-bus.c<br />&gt; index 8a1d3c7,125e7b7..0000000<br />&gt; --- a/drivers/pci/setup-bus.c<br />&gt; +++ b/drivers/pci/setup-bus.c<br />&gt; &#64;&#64;&#64; -783,16 -486,14 +783,14 &#64;&#64;&#64; void __ref __pci_bus_size_bridges(struc<br />&gt;                break;<br />&gt;<br />&gt;        case PCI_CLASS_BRIDGE_PCI:<br />&gt; +               /* don't size subtractive decoding (transparent)<br />&gt; +                * PCI-to-PCI bridges */<br />&gt; +               if (bus-&gt;self-&gt;transparent)<br />&gt; +                       break;<br /><br />The above is the real revert.<br /><br />The below should be totally independent, and I'd like to make sure<br />that you test the revert without this change:<br /><br />&gt;                pci_bridge_check_ranges(bus);<br />&gt; -               if (bus-&gt;self-&gt;is_hotplug_bridge) {<br />&gt; -                       additional_io_size  = pci_hotplug_io_size;<br />&gt; -                       additional_mem_size = pci_hotplug_mem_size;<br />&gt; -               }<br />&gt; -               /*<br />&gt; -                * Follow thru<br />&gt; -                */<br />&gt; +               /* fall through */<br />&gt;        default:<br />&gt;  -              pbus_size_io(bus);<br />&gt;  +              pbus_size_io(bus, 0, additional_io_size, add_head);<br /><br />And in fact I think that last line is just broken, you can't apply<br />that on my current -git. What's going on?<br /><br />Also, I'd like to see the output of:<br /><br /> - cat /proc/iomem<br /> - cat /proc/ioports<br /> - /sbin/lspci -vvxxx<br /><br />from that machine. And Bjorn asked for a full dmesg, and I see that<br />email, but it didn't get updated into the bugzilla entry (apparently<br />bugzilla is not smart enough to take email attachments and make them<br />bugzilla attachments). Rogério, can you do that so that it doesn't get<br />lost?<br /><br />                                 Linus<br />--<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.kernel.org<br />More majordomo info at  <a href="http://vger.kernel.org/majordomo-info.html">http://vger.kernel.org/majordomo-info.html</a><br />Please read the FAQ at  <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
