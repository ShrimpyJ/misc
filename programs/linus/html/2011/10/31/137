    </div></td><td width="32"> </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2011/10/26/277">First message in thread</a></li><li><a href="/lkml/2011/10/30/90">Linus Torvalds</a><ul><li><a href="/lkml/2011/10/31/37">James Bottomley</a><ul><li class="origin"><a href="/lkml/2011/10/31/188">Linus Torvalds</a><ul><li><a href="/lkml/2011/10/31/188">Junio C Hamano</a><ul><li><a href="/lkml/2011/10/31/274">Linus Torvalds</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2011/10/31/44">Ingo Molnar</a></li><li><a href="/lkml/2011/10/31/267">"H. Peter Anvin"</a><ul><li><a href="/lkml/2011/10/31/276">Linus Torvalds</a><ul><li><a href="/lkml/2011/10/31/277">"H. Peter Anvin"</a><ul><li><a href="/lkml/2011/10/31/284">Linus Torvalds</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2011/10/31/271">Junio C Hamano</a></li></ul></li></ul><div class="threadlist">Patch in this message</div><ul class="threadlist"><li><a href="/lkml/diff/2011/10/31/137/1">Get diff 1</a></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js"></script><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Mon, 31 Oct 2011 08:53:59 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [git patches] libata updates, GPG signed (but see admin notes)</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Mon, Oct 31, 2011 at 1:19 AM, James Bottomley<br />&lt;James.Bottomley&#64;hansenpartnership.com&gt; wrote:<br />&gt;<br />&gt;&gt; That said, even the "BEGIN PGP SIGNED MESSAGE" things are a massive<br />&gt;&gt; pain in the butt. We need to automate this some sane way, both for the<br />&gt;&gt; sender and for the recipient.<br />&gt;<br />&gt; But this doesn't help with what practise you want us to follow.  Do you<br />&gt; want us to send full signed email using pgp encapsulation for pull<br />&gt; requests in spite of the mangling it does to attached patches and the<br />&gt; amount of extra pain it causes you?<br /><br />No. I don't want the *whole* email signed, because that is quite<br />inconvenient: it means that I can't just cut-and-paste some signature,<br />I have to save the email and verify it etc etc.<br /><br />So my preferred thing would literally be to make the signed part as<br />small as possible with no odd characters or whitespace (top commit and<br />probably repository name), so that I can cut-and-paste it and just<br />have a terminal window open with "gpg --verify + paste + ^D" and I'm<br />done.<br /><br />For the people who use "git request-pull", I'm attaching a trivial<br />patch to make it add this kind of signature if you give it the "-s"<br />flag. It basically just adds a hunk like the appended crazy example to<br />the pull request, and it's small enough and simple enough that it<br />makes verification simple too with just the above kind of trivial<br />cut-and-paste thing.<br /><br />(Junio cc'd, I think he had something more complicated in mind)<br /><br />Now, admittedly it would be *even nicer* if this gpg-signed block was<br />instead uploaded as a signed tag automatically, and "git pull" would<br />notice such a signed tag (tagname the same as the branch name + date<br />or something) and would download and verify the tag as I pull. Then I<br />wouldn't even need to actually do the cut-and-paste at all. But this<br />is the *really* simple approach that gets up 95% of the way there.<br /><br />And the attached patch is so trivial that if you aren't actually using<br />"git request-pull" but instead have some home-cooked script to do the<br />same, then you can just look at this patch and trivially change your<br />script to do something very similar.<br /><br />                 Linus<br /><br />[ Example gpg-signed small block that the attached patch adds to the<br />pull request: ]<br /><br />-----BEGIN PGP SIGNED MESSAGE-----<br />Hash: SHA1<br /><br />Commit be3fa9125e708348c7baf04ebe9507a72a9d1800<br />from git.kernel.org/pub/git<br />-----BEGIN PGP SIGNATURE-----<br />Version: GnuPG v2.0.18 (GNU/Linux)<br /><br />iQEcBAEBAgAGBQJOrsILAAoJEHm+PkMAQRiGxZcH/31e0RrBitXUPKxHJajD58yh<br />SIEe/7i6E2RUSFva3KybEuFslcR8p8DYzDQTPLejStvnkO8v0lXu9s9R53tvjLMF<br />aaQXLOgrOC2RqvzP4F27O972h32YpLBkwIdWQGAhYcUOdKYDZ9RfgEgtdJwSYuL+<br />oJ7TjLrtkcILaFmr9nYZC+0Fh7z+84R8kR53v0iBHJQOFfssuMjUWCoj9aEY12t+<br />pywXuVk2FsuYvhniCAcyU6Y1K9aXaf6w5iOY2hx/ysXtUBnv92F7lcathxQkvgjO<br />fA7/TXEcummOv5KQFc9vckd5Z1gN2ync5jhfnmlT2uiobE6mNdCbOVlCOpsKQkU=<br />=l5PG<br />-----END PGP SIGNATURE-----<br /> git-request-pull.sh |    9 +++++++++<br /> 1 files changed, 9 insertions(+), 0 deletions(-)<br /><br />diff --git a/git-request-pull.sh b/git-request-pull.sh<br />index fc080cc5e45d..22b51930959f 100755<br />--- a/git-request-pull.sh<br />+++ b/git-request-pull.sh<br />&#64;&#64; -20,11 +20,14 &#64;&#64; GIT_PAGER=<br /> export GIT_PAGER<br /> <br /> patch=<br />+sign=<br /> while	case "$#" in 0) break ;; esac<br /> do<br /> 	case "$1" in<br /> 	-p)<br /> 		patch=-p ;;<br />+	-s)<br />+		sign=-s ;;<br /> 	--)<br /> 		shift; break ;;<br /> 	-*)<br />&#64;&#64; -73,6 +76,12 &#64;&#64; are available in the git repository at:' $baserev &amp;&amp;<br /> echo "  $url $branch" &amp;&amp;<br /> echo &amp;&amp;<br /> <br />+if test -n "$sign"<br />+then<br />+	printf "Commit $headrev\nfrom $url\n" | gpg --clearsign<br />+	echo<br />+fi &amp;&amp;<br />+<br /> git shortlog ^$baserev $headrev &amp;&amp;<br /> git diff -M --stat --summary $patch $merge_base..$headrev || exit<br /> exit $status</pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
