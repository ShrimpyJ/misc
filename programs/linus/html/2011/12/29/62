    </div></td><td width="32"> </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2011/12/29/41">First message in thread</a></li><li><a href="/lkml/2011/12/29/41">Ingo Molnar</a><ul><li class="origin"><a href="/lkml/2011/12/30/50">Linus Torvalds</a><ul><li><a href="/lkml/2011/12/30/50">Peter Zijlstra</a><ul><li><a href="/lkml/2011/12/30/60">Linus Torvalds</a><ul><li><a href="/lkml/2011/12/30/67">Hugh Dickins</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js"></script><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Thu, 29 Dec 2011 17:26:56 -0800</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [GIT PULL] futex fixlet</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Thu, Dec 29, 2011 at 1:07 PM, Ingo Molnar &lt;mingo&#64;elte.hu&gt; wrote:<br />&gt;<br />&gt; Please pull the latest core-urgent-for-linus git tree from:<br />&gt;<br />&gt;   git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip.git core-urgent-for-linus<br />&gt;<br />&gt; Please have a good look at it - it was probably not tested<br />&gt; by everyone with the usual vigor, due to holiday excesse^W<br />&gt; festivities.<br /><br />Ugh.<br /><br />It's not about the testing, that thing is disgusting, and I really dislike it.<br /><br />Why do we even bother to check "page-&gt;mapping" at all? What's the<br />*use* of that loop? My gut feeling is that *that* is the fundamental<br />problem, and we should just get rid of it, rather than add all these<br />totally random work-arounds for the problem.<br /><br />Peter Z? That "if (!page-&gt;mapping) goto again" actually goes back to<br />38d47c1b7075, in 2008. Why does it exist in the first place? There's<br />no comment nor explanation in the changelog.<br /><br />Why don't we just unconditionally return -EFAULT? What is the retry<br />actually supposed to *do*? If somebody races with a mmap/munmap, why<br />the hell would we care? What is it doing?<br /><br />So there's no way I'll pull that patch. Even if the patch is<br />technically correct, what it *really* needs is the comment about why<br />retrying would be needed and a good idea in the first place. The<br />comments about all the cases where retrying cannot work are completely<br />pointless without that much more important commentary.<br /><br />I really don't understand what race we could be fixing by retrying,<br />and why we should care about that race.<br /><br />                Linus<br />--<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.kernel.org<br />More majordomo info at  <a href="http://vger.kernel.org/majordomo-info.html">http://vger.kernel.org/majordomo-info.html</a><br />Please read the FAQ at  <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
