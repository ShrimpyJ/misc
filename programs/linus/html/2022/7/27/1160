    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2021/9/29/816">First message in thread</a></li><li><a href="/lkml/2021/10/1/405">Linus Torvalds</a><ul><li><a href="/lkml/2021/10/2/71">Alexander Popov</a><ul><li><a href="/lkml/2021/10/2/81">Steven Rostedt</a><ul><li><a href="/lkml/2021/10/2/144">Alexander Popov</a></li></ul></li><li><a href="/lkml/2021/10/2/147">Linus Torvalds</a><ul><li><a href="/lkml/2021/10/2/188">Alexander Popov</a><ul><li><a href="/lkml/2021/10/5/1174">(Eric W. Biederman)</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2022/7/27/688">Alexey Khoroshilov</a><ul><li><a href="/lkml/2022/7/27/918">Jann Horn</a><ul><li><a href="/lkml/2022/7/27/1176">Alexey Khoroshilov</a></li></ul></li><li class="origin"><a href="/lkml/2022/7/27/1504">Linus Torvalds</a><ul><li><a href="/lkml/2022/7/27/1504">Alexey Khoroshilov</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Wed, 27 Jul 2022 09:42:01 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [PATCH] Introduce the pkill_on_warn boot parameter</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Wed, Jul 27, 2022 at 9:17 AM Alexey Khoroshilov<br />&lt;khoroshilov&#64;ispras.ru&gt; wrote:<br />&gt;<br />&gt; We see a number of cases where WARNING is used to inform userspace that<br />&gt; it is doing something wrong, e.g.<br />&gt; <a href="https://elixir.bootlin.com/linux/v5.19-rc8/source/net/can/j1939/socket.c#L181">https://elixir.bootlin.com/linux/v5.19-rc8/source/net/can/j1939/socket.c#L181</a><br />&gt; <a href="https://elixir.bootlin.com/linux/v5.19-rc8/source/drivers/video/fbdev/core/fbmem.c#L1023">https://elixir.bootlin.com/linux/v5.19-rc8/source/drivers/video/fbdev/core/fbmem.c#L1023</a><br /><br />That first case is entirely bogus.<br /><br />WARN_ON() should only be used for "This cannot happen, but if it does,<br />I want to know how we got here".<br /><br />But the second case is fine: Using "pr_warn()" is fine. A kernel<br />warning (without a backtrace) is a normal thing for something that is<br />deprecated or questionable, and you want to tell the user that "this<br />app is doing something wrong".<br /><br />So if that j1939 thing is something that can be triggered by a user,<br />then the backtrace should be reported to the driver maintainer, and<br />then either<br /><br /> (a) the WARN_ON_ONCE() should just be removed ("ok, this can happen,<br />we understand why it can happen, and it's fine")<br /><br /> (b) the problem the WARN_ON_ONCE() reports about should be made<br />impossible some way<br /><br /> (c) it might be downgraded to a pr_warn() if people really want to<br />tell user space that "guys, you're doing something wrong" and it's<br />considered a useful warning.<br /><br />Honestly, for something like that j1939 can driver, I doubt (c) is<br />ever an option. The "return -EBUSY" is the only real information that<br />a user needs.<br /><br />               Linus<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
