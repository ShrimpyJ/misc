    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2022/7/26/728">First message in thread</a></li><li><a href="/lkml/2022/7/26/728">Yury Norov</a><ul><li><a href="/lkml/2022/7/26/904">Guenter Roeck</a><ul><li class="origin"><a href="">Linus Torvalds</a></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js"></script><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Tue, 26 Jul 2022 11:48:39 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [PATCH] arm: drop arch implementation for find_bit() functions</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Tue, Jul 26, 2022 at 11:35 AM Guenter Roeck &lt;linux&#64;roeck-us.net&gt; wrote:<br />&gt;<br />&gt; bitmap unit tests succeed, and the KFENCE report is no longer seen<br />&gt; even after 65 retries (previously it reproduced easily with 5-15<br />&gt; retries).<br />&gt;<br />&gt; Tested-by: Guenter Roeck &lt;linux&#64;roeck-us.net&gt;<br /><br />Russell, how do you want to handle this?<br /><br />It's not exactly super-critical, in that this whole issue with the<br />bitmap overrun probably not happening in real life outside of the<br />tests. And even when it does happen, it's probably just going to be a<br />read that nobody cares about (ie very unlikely to hit something like a<br />"next-page-is-not-mapped" situation).<br /><br />But it *could* trigger those kinds of things, I guess.<br /><br />I'll happily take the patch myself as-is, it seems very safe<br />(considering that all architectures except for 32-bit arm and m68k<br />already use the generic code).<br /><br />But as you pointed out, the arm code does the byte-at-a-time thing,<br />which *could* hide some other arm code using unaligned bitmaps.<br /><br />Of course, if you actually have unaligned bitmaps (and one of the arm<br />chips that don't handle unaligned accesses), you'd then probably have<br />been bitten by just the *regular* bitmap functions doing word accesses<br />anyway, so I don't really see that as being an issue - I don't expect<br />anybody would only use the find_bit() functions, and not use the<br />regular set/clear/test_bit() functions before/after.<br /><br />Anyway, the patch looks very safe and fixes a known - but likely<br />*very* minor - issue.<br /><br />Just let me know how you want to handle this:<br /><br /> (a) I'll take it directly on your say-so<br /><br /> (b) you have other things pending anyway and will apply it and send<br />me a pull request<br /><br /> (c) you are nervous enough that you prefer leaving this for the next<br />merge window<br /><br />I don't personally really see (c) as an issue, but I don't feel<br />strongly enough about it to really mind one way or another, so<br />whatever you feel is simplest and works best for you...<br /><br />                         Linus<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
