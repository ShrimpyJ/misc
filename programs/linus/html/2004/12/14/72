    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2004/11/26/106">First message in thread</a></li><li><a href="/lkml/2004/11/28/167">Linus Torvalds</a><ul><li><a href="/lkml/2004/11/28/176">Jeff Garzik</a><ul><li><a href="/lkml/2004/11/28/178">Al Viro</a><ul><li><a href="/lkml/2004/11/29/3">Tim Hockin</a></li></ul></li><li><a href="/lkml/2004/11/29/10">Arjan van de Ven</a></li><li><a href="/lkml/2004/12/4/107">Rob Landley</a><ul><li><a href="/lkml/2004/12/4/111">Andries Brouwer</a><ul><li><a href="/lkml/2004/12/5/40">David Greaves</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2004/11/29/15">David Woodhouse</a><ul><li><a href="/lkml/2004/11/30/21">Alex Riesen</a><ul><li><a href="/lkml/2004/11/30/33">Alex Riesen</a></li></ul></li><li><a href="/lkml/2004/12/1/57">Ralf Baechle</a><ul><li><a href="/lkml/2004/12/1/232">(H. Peter Anvin)</a></li></ul></li></ul></li><li><a href="/lkml/2004/11/29/16">Paul Mackerras</a><ul><li><a href="/lkml/2004/11/29/17">Arjan van de Ven</a><ul><li><a href="/lkml/2004/11/29/19">David Woodhouse</a></li></ul></li></ul></li><li><a href="/lkml/2004/11/29/52">Mariusz Mazur</a></li><li><a href="/lkml/2004/11/29/131">Alexandre Oliva</a><ul><li><a href="/lkml/2004/11/29/135">Linus Torvalds</a><ul><li><a href="/lkml/2004/11/29/234">Al Viro</a><ul><li><a href="/lkml/2004/12/1/55">Roman Zippel</a></li></ul></li><li><a href="/lkml/2004/11/29/246">Linus Torvalds</a><ul><li><a href="/lkml/2004/11/29/267">(H. Peter Anvin)</a></li><li><a href="/lkml/2004/11/30/2">Herbert Poetzl</a></li><li><a href="/lkml/2004/11/30/7">bert hubert</a></li><li><a href="/lkml/2004/11/30/229">Alexandre Oliva</a></li></ul></li><li><a href="/lkml/2004/11/30/94">David Howells</a><ul><li><a href="/lkml/2004/11/30/101">Linus Torvalds</a></li></ul></li><li><a href="/lkml/2004/11/30/95">David Woodhouse</a><ul><li><a href="/lkml/2004/11/30/103">Linus Torvalds</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2004/12/14/7">Werner Almesberger</a><ul><li class="origin"><a href="/lkml/2004/12/14/94">Linus Torvalds</a><ul><li><a href="/lkml/2004/12/14/94">Werner Almesberger</a><ul><li><a href="/lkml/2004/12/14/127">Linus Torvalds</a></li><li><a href="/lkml/2004/12/14/148">Horst von Brand</a></li></ul></li><li><a href="/lkml/2004/12/14/97">Andreas Schwab</a><ul><li><a href="/lkml/2004/12/14/123">Linus Torvalds</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Tue, 14 Dec 2004 07:49:05 -0800 (PST)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [RFC] Splitting kernel headers and deprecating __KERNEL__</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Tue, 14 Dec 2004, Werner Almesberger wrote:<br />&gt; <br />&gt; Hmm, so you're predicting problems if user space includes something<br />&gt; that uses uint32_t ? Wouldn't either of these work (descriptive file<br />&gt; names for clarity):<br />&gt; <br />&gt;  1) include/linux-user/foo.h:<br />&gt;     #include &lt;stdint.h&gt;<br />&gt;     #include &lt;linux-kernel-and-user-common/foo.h&gt;<br /><br />No. Because when you include &lt;sys/ioctl.h&gt; (which includes the <br />&lt;linux-user/foo.h&gt;, the POSIX/SuS/whatever namespace rules say that YOU <br />MUST NOT pollute the namespace with the names from stdint.h.<br /><br />The user is supposed to see "int32_t" and friends _only_ if the user <br />himself includes &lt;stdint.h&gt; or one of the very specific headers that is <br />documented by the standard to include it.<br /><br />Trust me. We are NOT going to use &lt;stdint.h&gt; in the kernel. <br /><br />This is a common issue with namespace pollution. For example, this program <br />is perfectly valid afaik (well, except for being _stupid_, but that's <br />another issue):<br /><br />	#include &lt;stdio.h&gt;<br /><br />	const char *int32_t(int i)<br />	{<br />		return i ? "non-zero" : "zero";<br />	}<br /><br />	int main(int argc, char **argv)<br />	{<br />		return printf("argc is %s\n", int32_t(argc));<br />	}<br /><br />Get the picture? The user may _use_ names that are defined for the <br />standard - like "strlen()" or "uint32_t" - for his own nefarious purposes, <br />because they are _only_ defined if you include the right header files.<br /><br />And trust me, the rules are really arcane. Not only do you have several <br />standards, and several versions, you have various local rules too, ie gcc <br />and glibc make up their own rules about things that depend on compiler <br />flags etc. <br /><br />And that is why a kernel header file must not define them, and by <br />implication, cannot use these names.<br /><br />Because the whole _point_ of having kernel header files that can be used <br />in user-space is that they are helpers for things like &lt;sys/ioctl.h&gt; etc, <br />that would just copy them.<br /><br />If we are going to pollute the user-visible namespace in random ways, the<br />whole discussion is pointless. At that point, glibc (or any other libc)  <br />can't use those API headers anyway.<br /><br />Remember: the _biggest_ reason to make kernel headers available is not to <br />user programs that want them, but to libc and friends.<br /><br />		Linus<br />-<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.kernel.org<br />More majordomo info at  <a href="http://vger.kernel.org/majordomo-info.html">http://vger.kernel.org/majordomo-info.html</a><br />Please read the FAQ at  <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
