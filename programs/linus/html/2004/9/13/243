    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2004/9/13/177">First message in thread</a></li><li><a href="/lkml/2004/9/13/177">Linus Torvalds</a><ul><li><a href="/lkml/2004/9/13/228">Christian Borntraeger</a><ul><li class="origin"><a href="/lkml/2004/9/13/249">Linus Torvalds</a><ul><li><a href="/lkml/2004/9/13/249">Andrew Morton</a><ul><li><a href="/lkml/2004/9/13/253">Christian Borntraeger</a></li></ul></li><li><a href="/lkml/2004/9/13/252">Christian Borntraeger</a><ul><li><a href="/lkml/2004/9/13/254">Linus Torvalds</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2004/9/13/267">Peter Osterlund</a><ul><li><a href="/lkml/2004/9/14/89">Gerd Knorr</a><ul><li><a href="/lkml/2004/9/14/400">Peter Osterlund</a><ul><li><a href="/lkml/2004/9/15/21">Gerd Knorr</a></li></ul></li></ul></li><li><a href="/lkml/2004/9/26/9">Peter Osterlund</a><ul><li><a href="/lkml/2004/9/26/67">Gerd Knorr</a></li></ul></li></ul></li><li><a href="/lkml/2004/9/14/164">Geert Uytterhoeven</a></li><li><a href="/lkml/2004/9/15/58">Eric BEGOT</a></li><li><a href="/lkml/2004/9/20/134">John Cherry</a><ul><li><a href="/lkml/2004/9/20/184">Giuseppe Bilotta</a><ul><li><a href="/lkml/2004/9/20/185">Jesper Juhl</a><ul><li><a href="/lkml/2004/9/20/209">Giuseppe Bilotta</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2004/10/11/247">Geert Uytterhoeven</a></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Mon, 13 Sep 2004 13:39:33 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: Linux 2.6.9-rc2 : oops</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Mon, 13 Sep 2004, Christian Borntraeger wrote:<br />&gt;<br />&gt; I got an oops with 2.6.9-rc2 in free_block. <br /><br />The disassembly is:<br /><br />		mov    0xc04fef10,%edx			edx is "mem_map"<br />		lea    0x40000000(%ecx),%eax		ecx is virtual address of "obj"<br />		shr    $0xc,%eax			eax is now pfn<br />		shl    $0x5,%eax			pfn * sizeof(struct page)<br />		mov    0x1c(%edx,%eax,1),%ebx		page-&gt;lru.prev<br />****		mov    0x4(%ebx),%edx			*****<br />		mov    (%ebx),%eax<br />		mov    %edx,0x4(%eax)<br />		mov    %eax,(%edx)<br /><br />and your "%ebx" value is obviously crap. In fact, it looks like your %ecx <br />is crap to begin with.<br /><br />Looks like this code (mm/slab.c: 2131):<br /><br />                slabp = GET_PAGE_SLAB(virt_to_page(objp));<br />		list_del(&amp;slabp-&gt;list);<br /><br />and in particular, you have "slabp" in %ebx, and the thing that oopses is <br />trying to load "entry-&gt;prev" in list_del(). <br /><br />Looking at the register state:<br /><br />	eax: 0080cc00   ebx: 013bab03   ecx: 00660044   edx: c1000000<br />	esi: c178f7e0   edi: 00000000   ebp: eff09f04   esp: eff09ee8<br /><br />That "ecx" value looks strange. It should be a kernel virtual address, and <br />it isn't.<br /><br />Looks like somebody is trying to free an invalid address. Sadly, your <br />traceback doesn't show _who_, because it's hidden in the buffering.<br /><br />The only changes to slab itself have been by Christoph lately, I don't <br />think that matters. Can you enable slab debugging? That should catch it <br />much earlier..<br /><br />		Linus<br />-<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.kernel.org<br />More majordomo info at  <a href="http://vger.kernel.org/majordomo-info.html">http://vger.kernel.org/majordomo-info.html</a><br />Please read the FAQ at  <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
