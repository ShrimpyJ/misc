    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2007/8/30/234">First message in thread</a></li><li><a href="/lkml/2007/8/31/24">Linus Torvalds</a><ul><li><a href="/lkml/2007/8/31/21">Linus Torvalds</a></li><li><a href="/lkml/2007/8/31/23">Trond Myklebust</a></li><li><a href="/lkml/2007/8/31/26">"Hua Zhong"</a></li><li><a href="/lkml/2007/8/31/31">Ian Kent</a><ul><li><a href="/lkml/2007/8/31/77">Martin Knoblauch</a></li></ul></li><li><a href="/lkml/2007/8/31/53">Jakob Oestergaard</a><ul><li class="origin"><a href="/lkml/2007/8/31/75">Linus Torvalds</a><ul><li><a href="/lkml/2007/8/31/75">Jakob Oestergaard</a><ul><li><a href="/lkml/2007/8/31/199">Linus Torvalds</a></li></ul></li><li><a href="/lkml/2007/8/31/118">Trond Myklebust</a><ul><li><a href="/lkml/2007/8/31/125">Frank van Maarseveen</a></li><li><a href="/lkml/2007/9/4/18">David Howells</a></li></ul></li></ul></li><li><a href="/lkml/2007/8/31/70">Frank van Maarseveen</a></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Fri, 31 Aug 2007 01:07:56 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: recent nfs change causes autofs regression</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Fri, 31 Aug 2007, Jakob Oestergaard wrote:<br />&gt; <br />&gt; Trond has a point Linus.<br /><br />I don't dispute that the new code does somethign good.<br /><br />But it changes existing behaviour.<br /><br />When we add NEW BEHAVIOUR, we don't add it to old interfaces when that <br />breaks old user mode! We add a new flag saying "I want the new behaviour".<br /><br />This is not rocket science, guys. This is very basic kernel behaviour. The <br />kernel exists only to serve user space, and that means that there is no <br />more important thing to do than to make sure you don't break existing <br />users, unless you have some *damns* strong reasons.<br /><br />&gt; What he "broke" is, for example, a ro mount being mounted as rw.<br /><br />No. What he broke was a working and sane setup.<br /><br />The fact that he may *also* have broken insane setups is totally <br />irrelevant. Don't go off on some tangent that has nothing to do with the <br />regression in question!<br /><br />&gt; If ext3 in some rare case (which would still mean it hit a few thousand users)<br />&gt; failed to remember that a file had been marked read-only and allowed writes to<br />&gt; it, wouldn't we want to fix that too?  It would cause regressions, but we'd fix<br />&gt; it, right?<br /><br />Stop blathering. Of course we fix security holes. But we don't break <br />things that don't need breaking. This wasn't a security hole.<br /><br />You are making up irrelevant arguments that have nothing to do with this <br />regression.<br /><br />If you want new behaviour, you add a new flag saying you want new <br />behaviour. You don't just start behaving differently from what you've <br />always done before (and what *other* UNIXes do, for that matter).<br /><br />Besides, even *if* it was a matter of somebody doing a mount with "rw", <br />when the previous mount was "ro", returning EBUSY is still the wrong thing <br />to do! If the user asks for a new mount that is read-write, he should just <br />get it - ie we should not re-use the old client handles, and we should do <br />what Solaris apparently does, namely to just make it a totally different <br />mount.<br /><br />In other words, it should (as I already mentioned once) have used <br />"nosharecache" by default, which makes it all work.<br /><br />Then, people who want to re-use the caches (which in turn may mean that <br />everything needs to have the same flags), THOSE PEOPLE, who want the NEW <br />SEMANTICS (errors and all) should then use a "sharecache" flag.<br /><br />See? You don't have to screw people over.<br /><br />&gt; mount passes back the error code on a failed mount. autofs passes that error<br />&gt; along too (when people configure syslog correctly). In short; when these<br />&gt; serious mistakes are made and caught, the admin sees an error in his logs.<br /><br />Bullshit. "Seeing the error in his logs" doesn't help anything. The <br />problem wasn't the lack of error, the problem was that it was a new and <br />unnecessary error in the first place. Logging it doesn't make it any less <br />buggy.<br /><br />			Linus<br />-<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.kernel.org<br />More majordomo info at  <a href="http://vger.kernel.org/majordomo-info.html">http://vger.kernel.org/majordomo-info.html</a><br />Please read the FAQ at  <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
