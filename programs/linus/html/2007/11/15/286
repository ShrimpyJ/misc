    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2007/11/15/74">First message in thread</a></li><li><a href="/lkml/2007/11/15/262">Linus Torvalds</a><ul><li><a href="/lkml/2007/11/15/271">Stephen Hemminger</a><ul><li><a href="/lkml/2007/11/15/288">Linus Torvalds</a></li><li><a href="/lkml/2007/11/15/428">Heikki Orsila</a></li></ul></li><li><a href="/lkml/2007/11/15/272">Greg KH</a><ul><li class="origin"><a href="/lkml/2007/11/15/313">Linus Torvalds</a><ul><li><a href="/lkml/2007/11/15/313">Greg KH</a></li><li><a href="/lkml/2007/11/16/281">Heikki Orsila</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Thu, 15 Nov 2007 08:48:58 -0800 (PST)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [patch 08/16] skge: fix ram buffer size calculation</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Thu, 15 Nov 2007, Greg KH wrote:<br /><br />&gt; On Thu, Nov 15, 2007 at 08:11:30AM -0800, Linus Torvalds wrote:<br />&gt; &gt; &gt; <br />&gt; &gt; &gt; patch 7fb7ac241162dc51ec0f7644d4a97b2855213c32 in mainline.<br />&gt; &gt; <br />&gt; &gt; This one is getting reverted in mainline in about five minutes (unless I <br />&gt; &gt; find an email from Stephen to address the reported regression - I haven't <br />&gt; &gt; gone through all my emails yet), so I don't think it should make it into <br />&gt; &gt; stable.<br />&gt; <br />&gt; Thanks for letting me know which patch is causing the problem, I just<br />&gt; got another report of the skge driver not working with all of these<br />&gt; patches applied.<br /><br />I suspect that's the same report.<br /><br />&gt; It looks like I'll just drop this one from the patch list, unless<br />&gt; Stephen has a better idea.<br /><br />This is my commit message for the revert - note the suggested possible <br />fix (but also why I didn't apply it, and why things got reverted).<br /><br />		Linus<br />---<br />commit 279e1dab949d33737557babfe9f74e0b74fbe39a<br />Author: Linus Torvalds &lt;torvalds&#64;woody.linux-foundation.org&gt;<br />Date:   Thu Nov 15 08:44:36 2007 -0800<br /><br />    Revert "skge: fix ram buffer size calculation"<br />    <br />    This reverts commit 7fb7ac241162dc51ec0f7644d4a97b2855213c32.<br />    <br />    Heikki Orsila reports that it causes a regression:<br />    <br />      "Doing<br />    <br />    	nc host port &lt; /dev/zero<br />    <br />       on a sending machine (not skge) to an skge machine that is receiving:<br />    <br />    	nc -l -p port &gt;/dev/null<br />    <br />       with ~60 MiB/s speed, causes the interface go malfunct. A slow<br />       transfer doesn't cause a problem."<br />    <br />    See<br />    <br />    	<a href="https://bugzilla.kernel.org/show_bug.cgi?id=9321">http://bugzilla.kernel.org/show_bug.cgi?id=9321</a><br />    <br />    for some more information.<br />    <br />    There is a workaround (also reported by Heikki):<br />    <br />      "After some fiddling, I noticed that not changing the register write<br />       order on patch:<br />    <br />       +       skge_write32(hw, RB_ADDR(q, RB_END), end);<br />               skge_write32(hw, RB_ADDR(q, RB_WP), start);<br />               skge_write32(hw, RB_ADDR(q, RB_RP), start);<br />       -       skge_write32(hw, RB_ADDR(q, RB_END), end);<br />    <br />       fixes the visible effect..  Possibly not the root cause of the<br />       problem, but changing the order back fixes networking here."<br />    <br />    but that has yet to be ack'ed or tested more widely, so the whole<br />    problem-causing commit gets reverted until this is resolved properly.<br />    <br />    Bisected-and-requested-by: Heikki Orsila &lt;shdl&#64;zakalwe.fi&gt;<br />    Cc: Stephen Hemminger &lt;shemminger&#64;linux-foundation.org&gt;<br />    Cc: Jeff Garzik &lt;jeff&#64;garzik.org&gt;<br />    Signed-off-by: Linus Torvalds &lt;torvalds&#64;linux-foundation.org&gt;<br /><br /> drivers/net/skge.c |   51 +++++++++++++++++++++++++++------------------------<br /> 1 files changed, 27 insertions(+), 24 deletions(-)<br />-<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.kernel.org<br />More majordomo info at  <a href="http://vger.kernel.org/majordomo-info.html">http://vger.kernel.org/majordomo-info.html</a><br />Please read the FAQ at  <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
