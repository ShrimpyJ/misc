    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2021/7/13/536">First message in thread</a></li><li class="origin"><a href="/lkml/2021/7/14/171">Linus Torvalds</a><ul><li><a href="/lkml/2021/7/14/171">"Chen, Rong A"</a></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Tue, 13 Jul 2021 12:52:11 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [mm/vmalloc] 5c1f4e690e: BUG:sleeping_function_called_from_invalid_context_at_mm/page_alloc.c</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">[ I've asked for this before, but I'll ask for it again.. ]<br /><br />On Tue, Jul 13, 2021 at 7:06 AM kernel test robot &lt;oliver.sang&#64;intel.com&gt; wrote:<br />&gt;<br />&gt;<br />&gt; [  131.014885] BUG: sleeping function called from invalid context at mm/page_alloc.c:4992<br />&gt; [  131.019428] in_atomic(): 0, irqs_disabled(): 1, non_block: 0, pid: 2928, name: trinity-c6<br />&gt; [  131.023996] no locks held by trinity-c6/2928.<br />&gt; [  131.027987] irq event stamp: 283042<br />&gt; [  131.031844] hardirqs last  enabled at (283041): [&lt;ffffffff8643af22&gt;] _raw_spin_unlock_irqrestore+0x42/0x50<br />&gt; [  131.036625] hardirqs last disabled at (283042): [&lt;ffffffff81656d71&gt;] __alloc_pages_bulk+0xae1/0xf20<br />&gt; [  131.041305] softirqs last  enabled at (281858): [&lt;ffffffff86800623&gt;] __do_softirq+0x623/0x9db<br />&gt; [  131.046157] softirqs last disabled at (281853): [&lt;ffffffff8116dfee&gt;] irq_exit_rcu+0xce/0xf0<br />&gt; [  131.050925] CPU: 0 PID: 2928 Comm: trinity-c6 Not tainted 5.13.0+ #1<br />&gt; [  131.055391] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.12.0-1 04/01/2014<br />&gt; [  131.060133] Call Trace:<br />&gt; [  131.064110]  dump_stack+0xa5/0xe6<br />&gt; [  131.068192]  ___might_sleep.cold+0x147/0x177<br />&gt; [  131.072324]  __alloc_pages+0x462/0x650<br /><br />Btw, can I ask the kernel test robot to do the same thing I asked<br />syzbot to do - namely get better backtrace annotations?<br /><br />It requires debug info in the kernel (but I think DEBUG_INFO_REDUCED<br />is sufficient, no need for the full one that blows sizes up a lot),<br />but it makes things _soo_ much easier to read. Not just because of<br />line numbers, but particularly with inlining information.<br /><br />It's easy enough to do: just run the kernel output through<br />"scripts/decode_stacktrace.sh".<br /><br />That will also do the "Code:" line instruction disassembly, which is<br />less critical, since that can be done later at any time with no loss<br />of information, but it can be a convenience.<br /><br />               Linus<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
