    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/1996/9/29/1">First message in thread</a></li><li><a href="/lkml/1996/9/29/1"> mcculley&#64;iag ...</a><ul><li><a href="/lkml/1996/9/30/8">Lars Wirzenius</a></li><li class="origin"><a href="">Linus Torvalds</a></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Sun, 29 Sep 1996 13:09:55 +0200 (EET)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: Increasing swap limits</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Sat, 28 Sep 1996 mcculley&#64;iag.net wrote:<br />&gt; <br />&gt; I would like to go out and buy a 2G disk and throw it in as a dedicated<br />&gt; swap drive.  However, from the docs and what I can understand in the<br />&gt; source, Linux can only handle 1G of swap made up of a maximum of 8<br />&gt; swapfiles or partitions of a maximum of 128M apiece.<br /><br />Right.<br /><br />&gt; It looks like all I have to do to increase the maximum number of swap<br />&gt; areas is to change MAX_SWAPFILES in the kernel source.<br /><br />Indeed. That's the easy way out - just increame MAX_SWAPFILES to 16 (or more<br />- there is _some_ limit, but I think the limit is something like 127 or<br />something like that, and even that limit is mainly due to some internal<br />non-present page representation that should be pretty easy to modify). <br /><br />&gt;						  But I would also<br />&gt; like to be able to use larger partitions.  To do that it looks like I<br />&gt; will have to change the swapfile format from a one-page map to a<br />&gt; multi-page map.  Is it this simple, or are there other non-obvious<br />&gt; factors that limit the maximum swap size?  If I understand correctly,<br />&gt; each process is limited to 3G of address space because of the way the<br />&gt; kernel space is mapped in, but shouldn't we be able to have much more<br />&gt; swap total?<br /><br />Yes, there is a 3GB per-process VM limit, but the total VM limit is probably<br />on the order of 2G _pages_, ie something like 8TB (now, that's the<br />theoretical limit on x86 with the current swap setup, in practice I don't<br />think you can easily approach that, but swap space in the hundreds of GB's<br />should be attainable). <br /><br />As you correctly have found out, the current 128MB swap limit is due to using<br />a one-page bitmap in the swap file, and no, there is nothing fundamental<br />about that (it just makes some things easier). You should be able to<br />reasonably easily extend the swap file format to have a multi-page bitmap,<br />and increase the current 128MB limit to 256 or 512GB by using two or four<br />pages for it all. <br /><br />		Linus<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
