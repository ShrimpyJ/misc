    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2008/9/29/149">First message in thread</a></li><li><a href="/lkml/2008/9/30/228">Rene Herman</a><ul><li><a href="/lkml/2008/9/30/242">Linus Torvalds</a><ul><li class="origin"><a href="/lkml/2008/9/30/263">Linus Torvalds</a><ul><li><a href="/lkml/2008/9/30/263">Linus Torvalds</a><ul><li><a href="/lkml/2008/9/30/311">Rene Herman</a></li><li><a href="/lkml/2008/9/30/315">Ingo Molnar</a></li></ul></li></ul></li><li><a href="/lkml/2008/9/30/283">Linus Torvalds</a><ul><li><a href="/lkml/2008/9/30/286">Linus Torvalds</a><ul><li><a href="/lkml/2008/9/30/322">Rene Herman</a></li></ul></li><li><a href="/lkml/2008/9/30/307">Bjorn Helgaas</a></li></ul></li><li><a href="/lkml/2008/9/30/304">Bjorn Helgaas</a><ul><li><a href="/lkml/2008/10/1/305">Bjorn Helgaas</a></li></ul></li></ul></li></ul></li></ul><div class="threadlist">Patch in this message</div><ul class="threadlist"><li><a href="/lkml/diff/2008/9/30/261/1">Get diff 1</a></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Tue, 30 Sep 2008 10:10:15 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [patch 2/2] PNP: don't check disabled PCI BARs for conflicts in quirk_system_pci_resources()</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Tue, 30 Sep 2008, Linus Torvalds wrote:<br />&gt; <br />&gt; It's a scary change right now, and I wouldn't commit it as is (I think <br />&gt; that for 2.6.27 the thing to do is to just do the minimal "zero means <br />&gt; disabled" thing), but having some random driver level initialize before <br />&gt; the core architecture-specific PCI code does smell. So something like this <br />&gt; sounds conceptually right anyway.<br /><br />A clearer (and more flexible) solution might be this patch. It's more <br />explicit about the fact that it simply makes it clear that any drivers <br />that are added by the architecture Makefile will be _first_ in the list of <br />drivers.<br /><br />I suspect we should do the same with 'libs' and 'core' too, for that <br />matter, but we don't really use '*.a' libraries any more so link order <br />doesn't matter apart from initcall ordering. And libraries should hopfully <br />never have that issue. And 'core' is at least right now just the <br />initramfs thing. So in practice, it's probably only drivers/ that coul <br />have issues like this.<br /><br />Sam added to Cc, since this is a build issue. What do people think? <br /><br />Background: We are very careful to add 'drivers/pci' _before_ <br />'drivers/{acpi,pnp}' in the drivers/Makefile, but what happens now is that <br />since the arch Makefile adds it's own drivers to the very end, the really <br />core PCI initcalls actually get ordered at the end, not the beginning. <br /><br />		Linus<br /><br />---<br /> Makefile |    4 +++-<br /> 1 files changed, 3 insertions(+), 1 deletions(-)<br /><br />diff --git a/Makefile b/Makefile<br />index 1d03c16..642b9b9 100644<br />--- a/Makefile<br />+++ b/Makefile<br />&#64;&#64; -458,7 +458,6 &#64;&#64; scripts: scripts_basic include/config/auto.conf<br /> <br /> # Objects we will link into vmlinux / subdirs we need to visit<br /> init-y		:= init/<br />-drivers-y	:= drivers/ sound/ firmware/<br /> net-y		:= net/<br /> libs-y		:= lib/<br /> core-y		:= usr/<br />&#64;&#64; -517,6 +516,9 &#64;&#64; endif<br /> <br /> include $(srctree)/arch/$(SRCARCH)/Makefile<br /> <br />+# Do this _after_ the architecture may have added its own core drivers<br />+drivers-y	+= drivers/ sound/ firmware/<br />+<br /> ifneq (CONFIG_FRAME_WARN,0)<br /> KBUILD_CFLAGS += $(call cc-option,-Wframe-larger-than=${CONFIG_FRAME_WARN})<br /> endif<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
