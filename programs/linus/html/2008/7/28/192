    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2008/7/28/123">First message in thread</a></li><li><a href="/lkml/2008/7/28/123">Vitaly Mayatskikh</a><ul><li class="origin"><a href="/lkml/2008/7/29/238">Linus Torvalds</a><ul><li><a href="/lkml/2008/7/29/238">Vitaly Mayatskikh</a></li><li><a href="/lkml/2008/7/30/206">Vitaly Mayatskikh</a><ul><li><a href="/lkml/2008/7/30/366">Linus Torvalds</a><ul><li><a href="/lkml/2008/8/1/340">Linus Torvalds</a></li></ul></li></ul></li><li><a href="/lkml/2008/7/30/208">Vitaly Mayatskikh</a></li><li><a href="/lkml/2008/7/30/210">Vitaly Mayatskikh</a></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Mon, 28 Jul 2008 08:48:41 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [PATCH] x86: Optimize tail handling for copy_user</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Mon, 28 Jul 2008, Vitaly Mayatskikh wrote:<br />&gt;<br />&gt; Reduce protection faults count in copy_user_handle_tail routine by<br />&gt; limiting clear length to the end of page as was suggested by Linus.<br /><br />No, you did it wrong.<br /><br />The page _clearing_ has to be to the end of the copy. Yes, in practice, I <br />don't think the kernel actually very often does "copy_from_user()" calls <br />that are page crossers in the kernel, but they do happen.<br /><br />It's the _copy_ part that needn't cross pages, because we know that <br />something faulted, and we _know_ that it wasn't the clearing.<br /><br />Really: the clearing should be just a "memset()" with no limitations. It <br />can never fault without it being a serious bug, and then we should not fix <br />it up, but we should oops!<br /><br />			Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
