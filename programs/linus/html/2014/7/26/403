    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2014/7/17/100">First message in thread</a></li><li><a href="/lkml/2014/7/26/140">Linus Torvalds</a><ul><li><a href="/lkml/2014/7/26/196">Markus Trippelsdorf</a><ul><li><a href="/lkml/2014/7/26/350">Theodore Ts'o</a><ul><li><a href="/lkml/2014/7/26/372">Markus Trippelsdorf</a><ul><li><a href="/lkml/2014/7/26/430">Jakub Jelinek</a></li></ul></li></ul></li><li class="origin"><a href="/lkml/2014/7/26/329">Linus Torvalds</a><ul><li><a href="/lkml/2014/7/26/329">Linus Torvalds</a></li><li><a href="/lkml/2014/7/26/383">Markus Trippelsdorf</a></li><li><a href="/lkml/2014/7/26/402">Linus Torvalds</a></li><li><a href="/lkml/2014/7/27/176">=?windows-1252?Q?Michel_D=E4nzer?=</a><ul><li><a href="/lkml/2014/7/28/453">Linus Torvalds</a></li></ul></li><li><a href="/lkml/2014/7/28/291">(Frank Ch. Eigler)</a><ul><li><a href="/lkml/2014/7/28/288">Theodore Ts'o</a></li><li><a href="/lkml/2014/7/28/324">"Frank Ch. Eigler"</a></li><li><a href="/lkml/2014/7/28/452">Linus Torvalds</a></li></ul></li></ul></li></ul></li></ul></li></ul><div class="threadlist">Patch in this message</div><ul class="threadlist"><li><a href="/lkml/diff/2014/7/26/403/1">Get diff 1</a></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Sat, 26 Jul 2014 12:56:19 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: Random panic in load_balance() with 3.16-rc</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Sat, Jul 26, 2014 at 12:35 PM, Markus Trippelsdorf<br />&lt;markus&#64;trippelsdorf.de&gt; wrote:<br />&gt;<br />&gt; But fortunately the workaround for the new inode.c bug is the same as<br />&gt; for the original bug: -fno-var-tracking-assignments.<br />&gt;<br />&gt; It would make sense to enabled it unconditionally for all debug<br />&gt; configurations for now.<br /><br />So how is code generation affected - if at all? Does the whole<br />"var-tracking-assignments" thing *only* matter for debug information?<br /><br />Also, when was it introduced as an option? Can we just unconditionally<br />enable it, or do we need to be careful about gcc versions?<br /><br />I'd *like* a debug kernel to not differ significantly from a non-debug<br />kernel. Most sane kernel developers (where "sane" is "me" by<br />definition) do not tend to use debug kernels, because the debug<br />overhead is absolutely disgustingly enormous at build time. But if we<br />then have most users using distro kernels that had debug info enabled,<br />it would be sad if code generation differences are huge.<br /><br />So I'd prefer to just unconditionally add that<br />"-fno-var-tracking-assignments" to the build.<br /><br />I just tested it on one file (fs/dcache.c) and it made no difference<br />at all for my non-debug build. Is this expected?<br /><br />Because if the only effect of "-fno-var-tracking-assignments" is<br />potentially slightly worse debug information for variables, I'll<br />enable it in a jiffy if it fixes this code generation bug. But I'd<br />like to get that confirmed.<br /><br />Finally, for CONFIG_DEBUG_INFO_REDUCED, we already use<br />"-fno-var-tracking". Is that a stronger version that also disables<br />"var-tracking-assignments"?<br /><br />Also, Michel - can you try  this patch if you still have your<br />gcc-4.9.0 install, and send me the resulting fair.s file again?<br /><br />                        Linus<br /> Makefile | 2 ++<br /> 1 file changed, 2 insertions(+)<br /><br />diff --git a/Makefile b/Makefile<br />index 6b2774145d66..5147f3f23504 100644<br />--- a/Makefile<br />+++ b/Makefile<br />&#64;&#64; -688,6 +688,8 &#64;&#64; KBUILD_CFLAGS	+= -fomit-frame-pointer<br /> endif<br /> endif<br /> <br />+KBUILD_CFLAGS   += $(call cc-option, -fno-var-tracking-assignments)<br />+<br /> ifdef CONFIG_DEBUG_INFO<br /> KBUILD_CFLAGS	+= -g<br /> KBUILD_AFLAGS	+= -Wa,-gdwarf-2</pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
