    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2014/10/19/94">First message in thread</a></li><li><a href="/lkml/2014/10/19/201">Linus Torvalds</a><ul><li><a href="/lkml/2014/10/19/202">"Kirill A. Shutemov"</a><ul><li><a href="/lkml/2014/10/19/206">Al Viro</a></li><li><a href="/lkml/2014/10/19/208">"Kirill A. Shutemov"</a><ul><li><a href="/lkml/2014/10/19/211">Al Viro</a></li></ul></li><li class="origin"><a href="/lkml/2014/10/19/217">Linus Torvalds</a><ul><li><a href="/lkml/2014/10/19/217">Sasha Levin</a><ul><li><a href="/lkml/2014/10/19/219">Linus Torvalds</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2014/10/19/210">	pinskia&#64;gmail ...</a></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Sun, 19 Oct 2014 16:49:16 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [PATCH] kernel: use the gnu89 standard explicitly</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Sun, Oct 19, 2014 at 4:10 PM, Kirill A. Shutemov<br />&lt;kirill&#64;shutemov.name&gt; wrote:<br />&gt;<br />&gt; IIUC, it's nothing to do with volatile. C11 and above reads<br />&gt;<br />&gt;         (rwlock_t) { .raw_lock = { 0 }, }<br />&gt;<br />&gt; as compound literal (which is not constant) rather than constant<br />&gt; initalizer plus a cast.<br /><br />Ahh. I thought it was the volatile, just because of the "constant"<br />part and the fact that it looked like the test-case was minimal. But<br />apparently that was just a red herring.<br /><br />So it's just the fact that C11 hasn't got the useful GNU extension of<br />a cast-with-initializer, and then that extension got removed (probably<br />just an oversight) because people thought that the "standard" C11<br />initializers were good enough.<br /><br />And it sounds like this will get fixed (perhaps already is) in gcc anyway.<br /><br />So maybe we need to do that "--std=gnu89" as a temporary workaround,<br />but not as long long-term "newer versions are broken".<br /><br />That doesn't sound too bad. My main objection to the patch was a<br />"let's try to fix this properly instead", but if the breakage is just<br />a temporary problem, there's no issue with "properly". Although it<br />does look like the *placement* of the --std=gnu89 was incorrect in<br />that original patch, so it needs updating regardless.<br /><br />AndrewP, mind explaing the other difference you mentioned (ie wrt<br />"extern inline")? I thought we had already long since ended up<br />following the gcc semantics (ie use "static inline" if we don't have<br />an external version somehwre), what exactly changed?<br /><br />Thanks,<br /><br />                       Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
