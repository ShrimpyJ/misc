    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2003/10/20/264">First message in thread</a></li><li><a href="/lkml/2003/10/23/170">Linus Torvalds</a><ul><li><a href="/lkml/2003/10/23/178">Eric Anholt</a></li><li><a href="/lkml/2003/10/23/195">Jeff Garzik</a><ul><li><a href="/lkml/2003/10/23/198">Jon Smirl</a></li><li><a href="/lkml/2003/10/23/210">Jon Smirl</a><ul><li><a href="/lkml/2003/10/24/2">Linus Torvalds</a><ul><li><a href="/lkml/2003/10/28/102">James Simmons</a></li></ul></li></ul></li><li><a href="/lkml/2003/10/24/89">Linus Torvalds</a><ul><li><a href="/lkml/2003/10/24/92">Petr Vandrovec</a><ul><li><a href="/lkml/2003/10/24/103">Linus Torvalds</a></li><li><a href="/lkml/2003/10/24/118">Ivan Kokshaysky</a></li></ul></li><li><a href="/lkml/2003/10/24/95">Jeff Garzik</a></li></ul></li></ul></li><li><a href="/lkml/2003/10/23/199">Jon Smirl</a></li><li><a href="/lkml/2003/10/25/42">Egbert Eich</a><ul><li class="origin"><a href="/lkml/2003/10/25/54">Linus Torvalds</a><ul><li><a href="/lkml/2003/10/25/54">Jeff Garzik</a><ul><li><a href="/lkml/2003/10/27/76">Ingo Oeser</a></li><li><a href="/lkml/2003/10/27/80">Keith Whitwell</a></li></ul></li><li><a href="/lkml/2003/10/25/75">Jon Smirl</a></li><li><a href="/lkml/2003/10/25/89">Benjamin Herrenschmidt</a></li><li><a href="/lkml/2003/10/27/70"> jlnance&#64;unity ...</a></li><li><a href="/lkml/2003/10/27/81">Keith Whitwell</a></li><li><a href="/lkml/2003/10/27/82">(Eric W. Biederman)</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Sat, 25 Oct 2003 11:37:05 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [Dri-devel] Re: [Linux-fbdev-devel] DRM and pci_driver conversion</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br />On Sat, 25 Oct 2003, Egbert Eich wrote:<br />&gt; <br />&gt; Speaking of XFree86: when I developed the PCI resource stuff in <br />&gt; XFree86 I was trying to get support from kernel folks to get the <br />&gt; appropriate user space interfaces into the kernel. When I got <br />&gt; nowhere I decided to do everything myself. <br /><br />There won't be any "user space interfaces". There are perfectly good <br />in-kernel interfaces, and anybody who needs them needs to be in kernel <br />space. Ie the kernel interfaces are for kernel modules, not for user space <br />accesses.<br /><br />The kernel module can be a simple interface layer like DRI, but the thing <br />is, it needs to be specific to some kind of hardware. I refuse to have <br />some kind of crap "user space driver" interface - drivers in user space <br />are a mistake. <br /><br />&gt; Is there any API that allows one to do this from user space?<br /><br />No. And I don't really see any huge reason for it.<br /><br />&gt; There are plenty of XFree86 drivers around that don't have a<br />&gt; DRM kernel module and it should  be possible to run those which<br />&gt; do without DRI support, therefore it would be a good if the<br />&gt; XFree86 driver could do this registration itself.<br /><br />If you do this, do it _right_. Look at what X really needs, and make a<br />driver for it. A _real_ driver. Not just a half-hearted "we want to do<br />things in user space, but we can't".<br /><br />Face it, a good graphics driver needs more than just "set up the ROM". It<br />needs DMA access, and the ability to use interrupts. It needs a real <br />driver.<br /><br />It basically needs something like what the DRI modules tend to do.<br /><br />I'd be really happy to have real graphics drivers in the kernel, but quite<br />frankly, so far the abstractions I've seen have sucked dead donkeys<br />through a straw. "fbcon" does way too much (it's not a driver, it's more a<br />text delivery system and a mode switcher). And DRI is too complex and<br />fluid to be a good low-level driver.<br /><br />Quite frankly, I'd much rather see a low-level graphics driver that does<br />_two_ things, and those things only:<br /><br /> - basic hardware enumeration and setup (and no, "basic setup" does not<br />   mean "mode switching": it literally means things like doing the <br />   pci_enable_device() stuff.<br /><br /> - serialization and arbitrary command queuing from a _trusted_ party (ie<br />   it could take command lists from the X server, but not from untrusted<br />   clients). This part basically boils down to "DMA and interrupts". This <br />   is the part that allows others to wait for command completion, "enough <br />   space in the ring buffers" etc. But it does _not_ know or care what the <br />   commands are.<br /><br />Then, fbcon and DRI and X could all three use these basics - and they'd be<br />_so_ basic that the hardware layer could be really stable (unlike the DRI<br />code that tends to have to upgrade for each new type of command that DRI<br />adds - since it has to take care of untrusted clients. So DRI would<br />basically use the low-level driver as a separate module, the way it<br />already uses AGP).<br /><br />But I'm _not_ interested in some interfaces to let user mode just bypass <br />the kernel. Because they will not solve any of the other problems that <br />clearly _do_ need solving, and if the X server continues to believe that <br />it can just access the hardware directly, it will never play well together <br />with projects like fbcon/dri.<br /><br />			Linus<br /><br />-<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.kernel.org<br />More majordomo info at  <a href="http://vger.kernel.org/majordomo-info.html">http://vger.kernel.org/majordomo-info.html</a><br />Please read the FAQ at  <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
