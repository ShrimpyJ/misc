    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2016/11/22/775">First message in thread</a></li><li class="origin"><a href="/lkml/2016/11/22/787">Linus Torvalds</a><ul><li><a href="/lkml/2016/11/22/787">Eric Dumazet</a><ul><li><a href="/lkml/2016/11/22/828">Linus Torvalds</a></li></ul></li><li><a href="/lkml/2016/11/22/790">Andre Noll</a></li><li><a href="/lkml/2016/11/23/17">Fengguang Wu</a><ul><li><a href="/lkml/2016/11/23/25">Linus Torvalds</a><ul><li><a href="/lkml/2016/11/23/67">Fengguang Wu</a></li><li><a href="/lkml/2016/11/23/84">Ye Xiaolong</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js"></script><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Tue, 22 Nov 2016 14:04:42 -0800</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [net] 34fad54c25: kernel BUG at include/linux/skbuff.h:1935!</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">David, Eric,<br /><br /> what's the situation on this issue? The bisection looks a bit odd,<br />but the commit in question does end up changing the key_control-&gt;thoff<br />value for the failure case, so maybe that in turn ends up screwing up<br />a later skb_pull.<br /><br />I'm not seeing anything that might fix this in the last networking<br />pull, but I may have missed something.<br /><br />I also noticed that the kernel test robot had screwed up the<br />participants list for some reason, and had<br /><br />  "Acked-by: Alexander Duyck &lt;alexander.h.duyck&#64;intel.com&gt;, David S.<br />Miller" &lt;davem&#64;davemloft.net&gt;<br /><br />as one of the participants. So there's some odd commit parsing issue<br />there somewhere. But Alexander seems to have seen this report despite<br />that, it just never went anywhere that I can tell.<br /><br />                Linus<br /><br />On Tue, Nov 15, 2016 at 1:20 PM, kernel test robot<br />&lt;xiaolong.ye&#64;intel.com&gt; wrote:<br />&gt;<br />&gt; FYI, we noticed the following commit:<br />&gt;<br />&gt; <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git</a> master<br />&gt; commit 34fad54c2537f7c99d07375e50cb30aa3c23bd83 ("net: __skb_flow_dissect() must cap its return value")<br />&gt;<br />&gt; in testcase: pbzip2<br />&gt; with following parameters:<br />&gt;<br />&gt;         nr_threads: 25%<br />&gt;         blocksize: 900K<br />&gt;         cpufreq_governor: performance<br />&gt;<br />&gt;<br />&gt;<br />&gt; on test machine: 48 threads 2 sockets Intel(R) Xeon(R) CPU E5-2697 v2 &#64; 2.70GHz with 64G memory<br />&gt;<br />&gt; caused below changes:<br />&gt;<br />&gt;<br />&gt; +------------------------------------------------------------------+------------+------------+<br />&gt; |                                                                  | 79774d6bfa | 34fad54c25 |<br />&gt; +------------------------------------------------------------------+------------+------------+<br />&gt; | boot_successes                                                   | 0          | 2          |<br />&gt; | boot_failures                                                    | 2          | 20         |<br />&gt; | invoked_oom-killer:gfp_mask=0x                                   | 2          | 2          |<br />&gt; | Mem-Info                                                         | 2          | 2          |<br />&gt; | Kernel_panic-not_syncing:Out_of_memory_and_no_killable_processes | 2          | 2          |<br />&gt; | kernel_BUG_at_include/linux/skbuff.h                             | 0          | 16         |<br />&gt; | invalid_opcode:#[##]SMP                                          | 0          | 16         |<br />&gt; | RIP:eth_type_trans                                               | 0          | 16         |<br />&gt; | Kernel_panic-not_syncing:Fatal_exception_in_interrupt            | 0          | 15         |<br />&gt; | calltrace:hub_event                                              | 0          | 1          |<br />&gt; | WARNING:at_fs/sysfs/dir.c:#sysfs_warn_dup                        | 0          | 2          |<br />&gt; | calltrace:parport_pc_init                                        | 0          | 2          |<br />&gt; | calltrace:SyS_finit_module                                       | 0          | 2          |<br />&gt; | WARNING:at_lib/kobject.c:#kobject_add_internal                   | 0          | 2          |<br />&gt; +------------------------------------------------------------------+------------+------------+<br />&gt;<br />&gt;<br />&gt;<br />&gt; [   19.375251] IPv6: ADDRCONF(NETDEV_UP): eth1: link is not ready<br />&gt; [   19.388892] Sending DHCP requests .<br />&gt; [   19.388892] ------------[ cut here ]------------<br />&gt; [   19.388894] kernel BUG at include/linux/skbuff.h:1935!<br />&gt; [   19.388895] invalid opcode: 0000 [#1] SMP<br />&gt; [   19.388896] Modules linked in:<br />&gt; [   19.388897] CPU: 0 PID: 0 Comm: swapper/0 Not tainted 4.9.0-rc3-00320-g34fad54 #1<br />&gt; [   19.388898] Hardware name: Intel Corporation S2600WP/S2600WP, BIOS SE5C600.86B.02.02.0002.122320131210 12/23/2013<br />&gt; [   19.388899] task: ffffffff81e0e4c0 task.stack: ffffffff81e00000<br />&gt; [   19.388904] RIP: 0010:[&lt;ffffffff81837c48&gt;]  [&lt;ffffffff81837c48&gt;] eth_type_trans+0xe8/0x140<br />&gt; [   19.388904] RSP: 0000:ffff88081e803db8  EFLAGS: 00010297<br />&gt; [   19.388905] RAX: 0000000000000152 RBX: ffff88080221f200 RCX: 0000000000001073<br />&gt; [   19.388905] RDX: ffff8808013afdc0 RSI: ffff880801114000 RDI: ffff880819407c00<br />&gt; [   19.388906] RBP: ffff88081e803e20 R08: ffff880801114000 R09: 0000000000000800<br />&gt; [   19.388907] R10: ffff8808013afec0 R11: ffffea003fd5a880 R12: ffff880819407c00<br />&gt; [   19.388907] R13: ffff881033408000 R14: ffffc9000843e000 R15: 0000000000000158<br />&gt; [   19.388908] FS:  0000000000000000(0000) GS:ffff88081e800000(0000) knlGS:0000000000000000<br />&gt; [   19.388909] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033<br />&gt; [   19.388910] CR2: ffff88103ffff000 CR3: 0000000001e07000 CR4: 00000000001406f0<br />&gt; [   19.388910] Stack:<br />&gt; [   19.388912]  ffffffff816905a7 ffffea003fd5a880 ffffea0000000008 ffff88080221f050<br />&gt; [   19.388913]  ffff88080221f000 0000004000000160 ffffea003fd5a880 0000000000000000<br />&gt; [   19.388915]  0000000000000040 0000000000000000 ffff88080221f050 ffff88100d216000<br />&gt; [   19.388915] Call Trace:<br />&gt; [   19.388919]  &lt;IRQ&gt;<br />&gt; [   19.388919]  [&lt;ffffffff816905a7&gt;] ? igb_clean_rx_irq+0x6a7/0x7d0<br />&gt; [   19.388921]  [&lt;ffffffff81690a52&gt;] igb_poll+0x382/0x700<br />&gt; [   19.388922]  [&lt;ffffffff81690a67&gt;] ? igb_poll+0x397/0x700<br />&gt; [   19.388925]  [&lt;ffffffff8180f2d7&gt;] net_rx_action+0x217/0x360<br />&gt; [   19.388928]  [&lt;ffffffff81957fb4&gt;] __do_softirq+0x104/0x2ab<br />&gt; [   19.388931]  [&lt;ffffffff81086961&gt;] irq_exit+0xf1/0x100<br />&gt; [   19.388932]  [&lt;ffffffff81957cf4&gt;] do_IRQ+0x54/0xd0<br />&gt; [   19.388935]  [&lt;ffffffff81955b8c&gt;] common_interrupt+0x8c/0x8c<br />&gt; [   19.388938]  &lt;EOI&gt;<br />&gt; [   19.388938]  [&lt;ffffffff817c1d12&gt;] ? cpuidle_enter_state+0x122/0x2e0<br />&gt; [   19.388939]  [&lt;ffffffff817c1f07&gt;] cpuidle_enter+0x17/0x20<br />&gt; [   19.388942]  [&lt;ffffffff810c64c3&gt;] call_cpuidle+0x23/0x40<br />&gt; [   19.388944]  [&lt;ffffffff810c66f4&gt;] cpu_startup_entry+0x114/0x200<br />&gt; [   19.388946]  [&lt;ffffffff81947675&gt;] rest_init+0x85/0x90<br />&gt; [   19.388950]  [&lt;ffffffff81ffbf5c&gt;] start_kernel+0x407/0x414<br />&gt; [   19.388952]  [&lt;ffffffff81ffb120&gt;] ? early_idt_handler_array+0x120/0x120<br />&gt; [   19.388953]  [&lt;ffffffff81ffb2d6&gt;] x86_64_start_reservations+0x2a/0x2c<br />&gt; [   19.388955]  [&lt;ffffffff81ffb415&gt;] x86_64_start_kernel+0x13d/0x14c<br />&gt; [   19.388968] Code: 00 04 00 00 c9 c3 48 33 86 70 03 00 00 48 c1 e0 10 48 85 c0 0f b6 87 90 00 00 00 75 28 83 e0 f8 83 c8 01 88 87 90 00 00 00 eb 82 &lt;0f&gt; 0b 0f b6 87 90 00 00 00 83 e0 f8 83 c8 03 88 87 90 00 00 00<br />&gt; [   19.388970] RIP  [&lt;ffffffff81837c48&gt;] eth_type_trans+0xe8/0x140<br />&gt; [   19.388970]  RSP &lt;ffff88081e803db8&gt;<br />&gt; [   19.388996] ---[ end trace 107996155a43a15c ]---<br />&gt; [   19.393422] Kernel panic - not syncing: Fatal exception in interrupt<br />&gt;<br />&gt;<br />&gt; To reproduce:<br />&gt;<br />&gt;         git clone git://git.kernel.org/pub/scm/linux/kernel/git/wfg/lkp-tests.git<br />&gt;         cd lkp-tests<br />&gt;         bin/lkp install job.yaml  # job file is attached in this email<br />&gt;         bin/lkp run     job.yaml<br />&gt;<br />&gt;<br />&gt;<br />&gt; Thanks,<br />&gt; Kernel Test Robot<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
