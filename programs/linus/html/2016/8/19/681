    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2016/8/17/583">First message in thread</a></li><li><a href="/lkml/2016/8/17/583">Kees Cook</a><ul><li><a href="/lkml/2016/8/18/597">Rik van Riel</a><ul><li><a href="/lkml/2016/8/18/1047">Linus Torvalds</a><ul><li><a href="/lkml/2016/8/18/849">Rik van Riel</a><ul><li><a href="/lkml/2016/8/19/644">Kees Cook</a></li></ul></li></ul></li><li><a href="/lkml/2016/8/19/314">Michal Hocko</a></li></ul></li><li class="origin"><a href="/lkml/2016/8/19/696">Linus Torvalds</a><ul><li><a href="/lkml/2016/8/19/696">Kees Cook</a><ul><li><a href="/lkml/2016/8/19/698">Linus Torvalds</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js"></script><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Fri, 19 Aug 2016 12:41:39 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [PATCH] usercopy: Skip multi-page bounds checking on SLOB</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Wed, Aug 17, 2016 at 3:29 PM, Kees Cook &lt;keescook&#64;chromium.org&gt; wrote:<br />&gt; When an allocator does not mark all allocations as PageSlab, or does not<br />&gt; mark multipage allocations with __GFP_COMP, hardened usercopy cannot<br />&gt; correctly validate the allocation. SLOB lacks this, so short-circuit<br />&gt; the checking for the allocators that aren't marked with<br />&gt; CONFIG_HAVE_HARDENED_USERCOPY_ALLOCATOR. This also updates the config<br />&gt; help and corrects a typo in the usercopy comments.<br /><br />I think I'm going to instead do just this:<br /><br />  diff --git a/security/Kconfig b/security/Kconfig<br />  index df28f2b6f3e1..da10d9b573a4 100644<br />  --- a/security/Kconfig<br />  +++ b/security/Kconfig<br />  &#64;&#64; -136,6 +136,7 &#64;&#64; config HAVE_ARCH_HARDENED_USERCOPY<br />   config HARDENED_USERCOPY<br />          bool "Harden memory copies between kernel and userspace"<br />          depends on HAVE_ARCH_HARDENED_USERCOPY<br />  +       depends on HAVE_HARDENED_USERCOPY_ALLOCATOR<br />          select BUG<br />          help<br />            This option checks for obviously wrong memory regions when<br /><br />which basically disables the hardened usercopy for SLOB systems.<br />Nobody cares, because nobody should use SLOB anyway, and certainly<br />wouldn't use it with hardening.<br /><br />Let's see if we get any other warnings with that..<br /><br />              Linus<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
