    </div></td><td width="32"> </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2016/10/17/583">First message in thread</a></li><li><a href="/lkml/2016/10/18/152">Sedat Dilek</a><ul><li><a href="/lkml/2016/10/18/558">=?UTF-8?Q?J=C3=B6rg_Otte?=</a><ul><li class="origin"><a href="/lkml/2016/10/19/299">Linus Torvalds</a><ul><li><a href="/lkml/2016/10/19/299">=?UTF-8?Q?J=C3=B6rg_Otte?=</a><ul><li><a href="/lkml/2016/10/19/322">Linus Torvalds</a></li></ul></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js"></script><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Tue, 18 Oct 2016 10:19:25 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: [4.9-rc1] Build-time 2x slower</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">On Tue, Oct 18, 2016 at 9:49 AM, Jörg Otte &lt;jrg.otte&#64;gmail.com&gt; wrote:<br />&gt; On Tue, Oct 18, 2016 at 12:04 AM, Sedat Dilek &lt;sedat.dilek&#64;gmail.com&gt; wrote:<br />&gt;&gt;<br />&gt;&gt; not sure whom to address on this issue.<br />&gt;&gt;<br />&gt;&gt; I have built Linux v4.9-rc1, v4.8.2 and v4.4.25 kernels (in this<br />&gt;&gt; order) this morning.<br />&gt;&gt;<br />&gt;&gt; Building a Linux v4.8.2 under Linux v4.9-rc1 took two times longer.<br />&gt;&gt;<br />&gt;&gt; As usually I build with 2 parallel-make-jobs.<br />&gt;&gt; This takes approx. 30mins.<br />&gt;&gt; Under Linux v4.9-rc1 it took approx. an hour.<br />&gt;&gt;<br />&gt;&gt; My system is a Ubuntu/precise AMD64 (WUBI installation).<br />&gt;&gt; I use my normal build-environment.<br />&gt;<br />&gt; I can confirm the problem. I use 3 build jobs in parallel<br />&gt; and the kernel build takes 2,5 times longer.<br />&gt;<br />&gt; I'm only seeing 1 (of 4) cores are running with max frequency.<br />&gt; The other are running in minimum frequency. And this seems not<br />&gt; to be limited to build jobs however.<br />&gt;<br />&gt; The last known good kernel for me is  ..-4.8.0-14604-g29fbff8<br /><br />Well, there are a few merges in 4.9-rc1 since that<br />4.8.0-14604-g29fbff8 version, but the obvious ones are my pulls from:<br /><br />  Michal Marek (2):<br />     kbuild updates<br />     misc kbuild changes<br /><br />(My merge commit ID's are 50cff89837a4 and 84d69848c97f) with<br />everything else looking like "normal code updates".<br /><br />Michal: a 2.5x slowdown of the kernel build was presumably *not* intentional.<br /><br />I'm not seeing anything obvious, but if it's spending a lot more time<br />in fixdep, then it's that "strstr()" change. That commit seems to<br />assume that strstr() is fast, which is a debatable assumption and<br />might be wrong in some environments.<br /><br />But even with a "strstr()" written by a sloth that was dropped on its<br />head a few too many times when young, I can't see it being *that* much<br />slower.<br /><br />Can you do just a silly<br /><br />   perf record make -j8<br /><br />of the bad build, and see if something stands out when you do "perf report"?<br /><br />But maybe Michal has some ideas.<br /><br />              Linus<br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
