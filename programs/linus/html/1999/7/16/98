    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/1999/7/9/133">First message in thread</a></li><li><a href="/lkml/1999/7/16/70">Linus Torvalds</a><ul><li><a href="/lkml/1999/7/16/86">Craig Milo Rogers</a><ul><li class="origin"><a href="/lkml/1999/7/16/120">Linus Torvalds</a><ul><li><a href="/lkml/1999/7/16/120">Craig Milo Rogers</a></li></ul></li></ul></li><li><a href="/lkml/1999/7/16/147">Jonathan Walther</a><ul><li><a href="/lkml/1999/7/16/150">Linus Torvalds</a><ul><li><a href="/lkml/1999/7/17/3">Jonathan Walther</a><ul><li><a href="/lkml/1999/7/17/5">Linus Torvalds</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/1999/7/19/24">Pavel Machek</a></li><li><a href="/lkml/1999/7/25/54">Richard Henderson</a><ul><li><a href="/lkml/1999/7/25/56">Linus Torvalds</a><ul><li><a href="/lkml/1999/7/25/57">Richard Henderson</a></li><li><a href="/lkml/1999/7/25/84">Alan Modra</a></li><li><a href="/lkml/1999/7/26/51">Martin Mares</a><ul><li><a href="/lkml/1999/7/30/48">Geert Uytterhoeven</a></li></ul></li></ul></li><li><a href="/lkml/1999/7/25/59">"Andre M. Hedrick"</a><ul><li><a href="/lkml/1999/7/25/61">Richard Henderson</a></li></ul></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Fri, 16 Jul 1999 13:15:23 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: New kernel/resource.c</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Fri, 16 Jul 1999, Craig Milo Rogers wrote:<br />&gt; <br />&gt; 	Wouldn't it be clearer to call the two I/O resource spaces,<br />&gt; say, ioport_resources and iomap_resources (ioremap_resources,<br />&gt; iomem_resources, ...)?  In my abjectly humble (hah!) opinion, this<br />&gt; would be the Right Thing to Do.<br /><br />Sure. I can certainly change the name to "ioport" and "iomap".<br /><br />There are cases where people still do mixed-mode hardware (and "iomap"<br />might make sense for both their PCI side _and_ their "other" side), but<br />it's certainly so rare that I would not disagree with calling the "normal"<br />PCI/ISA/xxxx kind of thing ioport/iomap, and then some more BUS-specific<br />thing would do the "bus_mem_resrouce" (the way we now call it "PCI").<br /><br />&gt; 	I'm surprised by these claims; I'll attempt to disprove them.<br />&gt; When dealing with hot-swap implementations (PCMCIA, SCSI, PCI, etc.),<br />&gt; the electrical heirarchy tells you which physically related devices<br />&gt; will be removed when a disconnection event is noted; for example, a<br />&gt; PCMCIA card eject event for a multifunction PCMCIA card.<br /><br />Note that the _conceptual_ hierarchy often has a physical reason behind<br />them. There is no question that the conceptual hierarchy (ie the one you<br />want to embed into the actual resource tree) is often mapped onto a<br />physical layout.<br /><br />I'm saying that it's wrong to start with the physical layout and try to<br />"infer" some resources from that layout. I don't think you should try to<br />map the resources to PCI sub-buses, for example. I don't see the point in<br />having the PCI "ISA space" as a separate resource.<br /><br />But conceptually the notion of "this area contains removable devices" _is_<br />obviously a hierarchy issue. No question of that. That's why I wanted to<br />make the resource control hierarchical in the first place.<br /><br />I'm just saying that that issue actually has very little to do with the<br />bus. There might be a completely flat bus that has removable devices. Or<br />there may be a complex hierarchical bus that has partly removable devices.<br />The resource hierarchy should be concerned not with the physical layout of<br />the bus, but with the logical issue of "removability" for example.<br /><br />&gt; 	Should the electrical heirarchy be represented using the same<br />&gt; generic resource management tools as the I/O port allocations?<br />&gt; Perhaps, if it fits the problem; personally, I think that a simple<br />&gt; tree structure would be more appropriate here.  Should the kernel<br />&gt; maintain it, or should it be in user space?  Because of the<br />&gt; interactions with the device drivers, I'd prefer a kernel solution, I<br />&gt; think.<br /><br />We want a kernel representation, but it should not be tied to the<br />electrical buses.<br /><br />For example, the _physical_ network might look like this:<br /><br />	PCI ----+----   PCI-PCI	+------	PCI card<br />		|		|<br />		|		|<br />		|		+------ PCI card<br />		|<br />		+----	PCI-PCI	+------	PCI card<br />		|		|<br />		|		|<br />		|		+------ PCI card<br />		|<br />		+----	PCI-ISA +------ ISA card<br />		|		|<br />		|		|<br />		|		+------ ISA card<br />		|<br />		|<br />		+-----  PCI-PCMCIA ---- cardbus slot<br /><br />and yet I see absolutely no reason to make the resource tree that complex<br />at all. The resource tree should probably just contain the top-level PCI<br />space, and the only real sub-tree would be a few PCMCIA trees (depending<br />on how the PCMCIA subsystem wants to partition the PCI address space)<br /><br />This is why I don't think that the electrical stuff is all that important.<br /><br />		Linus<br /><br /><br />-<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.rutgers.edu<br />Please read the FAQ at <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
