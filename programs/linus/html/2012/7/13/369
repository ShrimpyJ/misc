    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2012/7/13/369">First message in thread</a></li><li class="origin"><a href="/lkml/2012/7/13/376">Linus Torvalds</a><ul><li><a href="/lkml/2012/7/13/376">Dave Jones</a><ul><li><a href="/lkml/2012/7/13/383">Linus Torvalds</a><ul><li><a href="/lkml/2012/7/13/412">Josh Boyer</a></li><li><a href="/lkml/2012/7/19/247">Steven Rostedt</a><ul><li><a href="/lkml/2012/7/19/265">Linus Torvalds</a></li><li><a href="/lkml/2012/7/19/266">Josh Boyer</a></li></ul></li></ul></li><li><a href="/lkml/2012/7/13/396">Geert Uytterhoeven</a></li><li><a href="/lkml/2012/7/13/403">Paul Bolle</a><ul><li><a href="/lkml/2012/7/13/404">Dave Jones</a><ul><li><a href="/lkml/2012/7/13/407">Tony Luck</a></li><li><a href="/lkml/2012/7/13/408">Paul Bolle</a></li><li><a href="/lkml/2012/7/13/422">Frank Rowand</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2012/7/13/379">Khalid Aziz</a></li><li><a href="/lkml/2012/7/13/380">"Myklebust, Trond"</a><ul><li><a href="/lkml/2012/7/13/400">richard -rw- weinberger</a><ul><li><a href="/lkml/2012/7/14/53">Borislav Petkov</a><ul><li><a href="/lkml/2012/7/14/70">Pekka Enberg</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2012/7/13/391">Casey Schaufler</a><ul><li><a href="/lkml/2012/7/13/393">Linus Torvalds</a><ul><li><a href="/lkml/2012/7/13/411">	david&#64;lang ...</a></li></ul></li></ul></li><li><a href="/lkml/2012/7/13/413">Jesper Juhl</a><ul><li><a href="/lkml/2012/7/13/419">	david&#64;lang ...</a></li><li><a href="/lkml/2012/7/14/47">Olivier Galibert</a></li></ul></li><li><a href="/lkml/2012/7/13/414">Hans de Bruin</a></li><li><a href="/lkml/2012/7/14/7">Ben Hutchings</a><ul><li><a href="/lkml/2012/7/14/74">Josh Boyer</a></li></ul></li><li><a href="/lkml/2012/7/18/614">Steven Yong</a></li><li><a href="/lkml/2012/7/20/100">Jiri Kosina</a><ul><li><a href="/lkml/2012/7/20/122">Sam Ravnborg</a></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Fri, 13 Jul 2012 13:37:41 -0700</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">[RFC] Simplifying kernel configuration for distro issues</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody">So this has long been one of my pet configuration peeves: as a user I<br />am perfectly happy answering the questions about what kinds of<br />hardware I want the kernel to support (I kind of know that), but many<br />of the "support infrastructure" questions are very opaque, and I have<br />no idea which of the them any particular distribution actually depends<br />on.<br /><br />And it tends to change over time. For example, F14 (iirc) started<br />using TMPFS and TMPFS_POSIX_ACL/XATTR for /dev. And starting in F16,<br />the initrd setup requires DEVTMPFS and DEVTMPFS_MOUNT. There's been<br />several times when I started with my old minimal config, and the<br />resulting kernel would boot, but something wouldn't quite work right,<br />and it can be very subtle indeed.<br /><br />Similarly, the distro ends up having very particular requirements for<br />exactly *which* security models it uses and needs, and they tend to<br />change over time. And now with systemd, CGROUPS suddenly aren't just<br />esoteric things that no normal person would want to use, but are used<br />for basic infrastructure. And I remember being surprised by OpenSUSE<br />suddenly needing the RAW table support for netfilter, because it had a<br />NOTRACK rule or something.<br /><br />The point I'm slowly getting to is that I would actually love to have<br />*distro* Kconfig-files, where the distribution would be able to say<br />"These are the minimums I *require* to work". So we'd have a "Distro"<br />submenu, where you could pick the distro(s) you use, and then pick<br />which release, and we'd have something like<br /><br /> - distro/Kconfig:<br /><br />    config DISTRO_REQUIREMENTS<br />        bool "Pick minimal distribution requirements"<br /><br />    choice DISTRO<br />        prompt "Distribution"<br />        depends on DISTRO_REQUIREMENTS<br /><br />    config FEDORA<br />    config OPENSUSE<br />    config UBUNTU<br />    ...<br /><br />    endchoice<br /><br />and then depending on the DISTRO config, we'd include one of the<br />distro-specific ones with lists of supported distro versions and then<br />the random config settings for that version:<br /><br /> - distro/Kconfig.suse:<br /><br />    config OPENSUSE_121<br />        select OPENSUSE_11<br />        select IP_NF_RAW  # ..<br /><br /> - distro/Kconfig.Fedora:<br /><br />    config FEDORA_16<br />        select FEDORA_15<br />        select DEVTMPFS               # F16 initrd needs this<br />        select DEVTMPFS_MOUNT  # .. and expects the kernel to mount<br />DEVTMPFS automatically<br />        ...<br /><br />    config FEDORA_17<br />        select FEDORA_16<br />        select CGROUP_xyzzy<br />        ...<br /><br />and the point would be that it would make it much easier for a normal<br />user (and quite frankly, I want to put myself in that group too) to<br />make a kernel config that "just works".<br /><br />Sure, you can copy the config file that came with the distro, but it<br />has tons of stuff that really isn't required. Not just in hardware,<br />but all the debug choices etc that are really a user choice. And it's<br />really hard to figure out - even for somebody like me - what a minimal<br />usable kernel is.<br /><br />And yes, I know about "make localmodconfig". That's missing the point<br />for the same reason the distro config is missing the point.<br /><br />Comments? It doesn't have to start out perfect, but I think it would<br />*really* help make the kernel configuration much easier for people.<br /><br />In addition to the "minimal distro settings", we might also have a few<br />"common platform" settings, so that you could basically do a "hey, I<br />have a modern PC laptop, make it pick the obvious stuff that a normal<br />person needs, like USB storage, FAT/VFAT support, the core power<br />management etc". The silly stuff that you need, and that<br />"localyesconfig" actually misses because if you haven't inserted a USB<br />thumb drive, you won't necessarily have the FAT module loaded, but we<br />all know you do want it in real life. But that's really independent<br />issue, so let's keep it to just distro core things at first, ok?<br /><br />Would something like this make sense to people? I really think that<br />"How do I generate a kernel config file" is one of those things that<br />keeps normal people from compiling their own kernel. And we *want*<br />people to compile their own kernel so that they can help with things<br />like bisecting etc. The more, the merrier.<br /><br />                    Linus<br /><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
