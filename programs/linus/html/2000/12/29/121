    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2000/12/29/121">First message in thread</a></li><li class="origin"><a href="/lkml/2000/12/29/48">Linus Torvalds</a><ul><li><a href="/lkml/2000/12/29/48">Dan Aloni</a></li><li><a href="/lkml/2000/12/29/105">Byron Stanoszek</a><ul><li><a href="/lkml/2000/12/29/55">Linus Torvalds</a></li><li><a href="/lkml/2000/12/30/3">Andi Kleen</a></li><li><a href="/lkml/2000/12/30/6">Linus Torvalds</a></li><li><a href="/lkml/2000/12/30/30">Graham Murray</a></li></ul></li><li><a href="/lkml/2000/12/29/109">Daniel Phillips</a><ul><li><a href="/lkml/2000/12/29/103">Linus Torvalds</a><ul><li><a href="/lkml/2000/12/30/78">Daniel Phillips</a><ul><li><a href="/lkml/2000/12/30/26">Alexander Viro</a></li><li><a href="/lkml/2000/12/30/82">Linus Torvalds</a></li></ul></li></ul></li></ul></li><li><a href="/lkml/2000/12/29/113">Alexander Viro</a><ul><li><a href="/lkml/2000/12/29/49">Linus Torvalds</a><ul><li><a href="/lkml/2000/12/30/95">Alexander Viro</a></li></ul></li></ul></li><li><a href="/lkml/2001/1/4/184">"Stephen C. Tweedie"</a><ul><li><a href="/lkml/2001/1/4/208"> &lt;stewart&#64;neuron ...</a></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><div id="bsap_1297613" class="bsarocks bsap_5aa49c00cc06c882289a1dd6a5e50b62"></div><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Fri, 29 Dec 2000 16:25:43 -0800 (PST)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">test13-pre6</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br />Ok, there's a test13-pre6 out there now, which does a partial sync with<br />Alan, in addition to hopefully fixing the innd shared mapping writeback<br />problem for good.  Thanks to Marcelo Tosatti and others..<br /><br />I've pounded on the shared dirty page writeback logic quite a bit, and<br />verified (by doing timings with "strace -ttT") that it should do the right<br />thing with sync/fsync/fdatasync/msync(MS_ASYNC)/msync(MS_SYNC).<br /><br />The reason I'm fairly confident that the problem is gone for good is that<br />the dirty page handling is now quite integral to the whole address space<br />code, and it fell out rather nicely from some mapping host cleanups.<br /><br />Al: this changes "mapping-&gt;host" to be truly defined as a pointer to the<br />inode that owns the mapping. That's how every user actually _used_ the<br />host pointer, so this cleans those up to not need any casts. The main<br />reason, however, is that we needed to have some FS-level anchor for dirty<br />pages in order to get the correct sync() semantics. If you think it's<br />worth it to have a notion of an anonymous host we need to add something<br />else.<br /><br />Stephen: mind trying your fsync/etc tests on this one, to verify that the<br />inode dirty stuff is all done right?<br /><br />Marco d'Itri and everybody else who has seen innd problems (or other<br />shared map problems): can you verify that test13-pre6 works for you?<br /><br />			Linus<br /><br />----<br /> - pre6:<br />   - Marc Joosen: BIOS int15/e820 memory query: don't assume %edx<br />     unchanged by the BIOS. Fixes at least some IBM ThinkPads.<br />   - Alan Cox: synchronize<br />   - Marcelo Tosatti &amp; me: properly sync dirty pages<br />   - Andreas Dilger: proper ext2 compat flag checking<br /><br /> - pre5:<br />   - NIIBE Yutaka: SuperH update<br />   - Geert Uytterhoeven: m68k update<br />   - David Miller: TCP RTO calc fix, UDP multicast fix etc<br />   - Duncan Laurie: ServerWorks PIRQ routing definition.<br />   - mm PageDirty cleanups, added sanity checks, and don't lose the bit. <br /><br /> - pre4:<br />   - Christoph Rohland: shmfs cleanup<br />   - Nicolas Pitre: don't forget loop.c flags<br />   - Geert Uytterhoeven: new-style m68k Makefiles<br />   - Neil Brown: knfsd cleanups, raid5 re-org<br />   - Andrea Arkangeli: update to LVM-0.9<br />   - LC Chang: sis900 driver doc update<br />   - David Miller: netfilter oops fix<br />   - Andrew Grover: acpi update<br /><br /> - pre3:<br />   - Christian Jullien: smc9194: proper dev_kfree_skb_irq<br />   - Cort Dougan: new-style PowerPC Makefiles<br />   - Andrew Morton, Petr Vandrovec: fix run_task_queue<br />   - Christoph Rohland: shmfs for shared memory handling<br /><br /> - pre2:<br />   - Kai Germaschewski: ISDN update (including Makefiles)<br />   - Jens Axboe: cdrom updates<br />   - Petr Vandrovec; Matrox G450 support<br />   - Bill Nottingham: fix FAT32 filesystems on 64-bit platforms<br />   - David Miller: sparc (and other) Makefile fixup<br />   - Andrea Arkangeli: alpha SMP TLB context fix (and cleanups)<br />   - Niels Kristian Bech Jensen: checkconfig, USB warnings<br />   - Andrew Grover: large ACPI update<br /><br /> - pre1:<br />   - me: drop support for old-style Makefiles entirely. Big.<br />   - me: check b_end_io at the IO submission path<br />   - me: fix "ptep_mkdirty()" (so that swapoff() works correctly)<br />   - fix fault case in copy_from_user() with a constant size, where<br />     ((size &amp; 3) == 3)<br /><br /><br />-<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.kernel.org<br />Please read the FAQ at <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
