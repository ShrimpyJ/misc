    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2000/8/23/187">First message in thread</a></li><li><a href="/lkml/2000/8/23/195">Linus Torvalds</a><ul><li><a href="/lkml/2000/8/24/147">Neil Brown</a><ul><li class="origin"><a href="">Linus Torvalds</a></li><li><a href="/lkml/2000/8/25/49">Neil Brown</a></li></ul></li></ul></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td colspan="2"><!--BuySellAds Zone Code--><script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js"></script><!--End BuySellAds Zone Code--></td></tr><tr><td><table><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Thu, 24 Aug 2000 09:02:28 -0700 (PDT)</td></tr><tr><td class="lp">From</td><td class="rp" itemprop="author">Linus Torvalds &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Re: PATCH - final (I hope) tidy up for generic_make_request interface</td></tr></table></td><td><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></td></tr></table><pre itemprop="articleBody"><br /><br />On Thu, 24 Aug 2000, Neil Brown wrote:<br />&gt; &gt; <br />&gt; &gt; Which implies that we should not have it in the generic path, but in the<br />&gt; &gt; per-queue path.  <br />&gt; <br />&gt; I'm beginning to see your point...<br />&gt; <br />&gt; Maybe we should then have a "blk_queue_highmem_capable(q,flag)" <br />&gt; function whereby drivers can tell elevator_make_request that they<br />&gt; are highmem aware, and so the create_bounce will be skipped ??<br /><br />No. No flags. That's the mistake SCSI did, and it is a fundamental<br />mistake. It makes it basically impossible to "shift out" old code.<br /><br />I'd much rather have two separate functions for this - sure, they can<br />share most of the code by using common inline functions and what not, but<br />I'd be a lot happier with drivers just using the function that they are<br />most comfortable with directly.<br /><br />Anyway, this is not a change I'd like to have at this point. This is<br />definitely a 2.5.x thing.<br /><br />&gt; md_make_request needs it (I thought) because it accesses the data in the<br />&gt; buffers ... sometimes.<br /><br />Yes. But like rd_make_request(), it only does so from the CPU, not from<br />any real device (obviously). So it doesn't actually need to create a<br />_physical_ bounce-buffer the way a real device needs to that does DMA etc.<br />It can just use the same "kmap()" functionality that all the other generic<br />kernel code uses. <br /><br />Real devices are special. We don't know what they will end up doing, and<br />some (many) of them actually care deeply about the physical address as<br />opposed to just wanting to have the CPU able to touch the page. <br /><br />&gt; So, in summary:<br />&gt;   I was advocating the "keep it simple for now" position advocated by<br />&gt;   the comment, and applying the one solution to all drivers.<br /><br />I agree with that notion. I don't think your patch was a bad one. I just<br />think that it would make it a more straightforward operation later when we<br />_do_ start to make it aware of clever devices to not do it the way you<br />did.<br /><br />		Linus<br /><br />-<br />To unsubscribe from this list: send the line "unsubscribe linux-kernel" in<br />the body of a message to majordomo&#64;vger.kernel.org<br />Please read the FAQ at <a href="http://www.tux.org/lkml/">http://www.tux.org/lkml/</a><br /><br /></pre><div align="center"><div class="shariff" data-services="[&quot;reddit&quot;]" data-theme="grey" data-lang="en" data-backend-url="//shariff.lkml.org/index.php"></div></div></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
